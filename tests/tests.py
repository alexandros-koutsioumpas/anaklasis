# This script checks the validity of calculations performed with all three callable functions in anaklasis
# against results generated by version 1.5 (August 2021). It is used as a test for the core calculations
# that can be used with future releases. If the 'All anaklasis tests passed!' is printed at the end of the run
# the all tests were successful.

from anaklasis import ref
import numpy as np
import os


# Test reflectivity calculation engine
curve=np.array([[1.00000000e-03, 9.99576488e-01, 9.99576488e-13],
       [1.29900000e-03, 9.99576464e-01, 2.84611619e-12],
       [1.59800000e-03, 9.99576438e-01, 6.51813138e-12],
       [1.89700000e-03, 9.99576460e-01, 1.29445019e-11],
       [2.19600000e-03, 9.99576454e-01, 2.32458462e-11],
       [2.49500000e-03, 9.99576465e-01, 3.87345239e-11],
       [2.79400000e-03, 9.99576482e-01, 6.09146336e-11],
       [3.09300000e-03, 9.99576439e-01, 9.14820084e-11],
       [3.39200000e-03, 9.99576471e-01, 1.32324237e-10],
       [3.69100000e-03, 9.99576484e-01, 1.85520630e-10],
       [3.99000000e-03, 9.99576478e-01, 2.53342243e-10],
       [4.28900000e-03, 9.99576464e-01, 3.38251870e-10],
       [4.58800000e-03, 9.99576461e-01, 4.42904056e-10],
       [4.88700000e-03, 9.99576479e-01, 5.70145084e-10],
       [5.18600000e-03, 9.99576481e-01, 7.23012955e-10],
       [5.48500000e-03, 9.99576467e-01, 9.04737415e-10],
       [5.78400000e-03, 9.99576472e-01, 1.11873999e-09],
       [6.08300000e-03, 9.99576478e-01, 1.36863390e-09],
       [6.38200000e-03, 9.99576464e-01, 1.65822409e-09],
       [6.68100000e-03, 9.99576471e-01, 1.99150734e-09],
       [6.98000000e-03, 9.99576456e-01, 2.37267202e-09],
       [7.27900000e-03, 9.99576454e-01, 2.80609839e-09],
       [7.57800000e-03, 9.99576453e-01, 3.29635837e-09],
       [7.87700000e-03, 9.99576464e-01, 3.84821567e-09],
       [8.17600000e-03, 9.99576438e-01, 4.46662550e-09],
       [8.47500000e-03, 9.99576493e-01, 5.15673557e-09],
       [8.77400000e-03, 9.99576464e-01, 5.92388395e-09],
       [9.07300000e-03, 9.99576467e-01, 6.77360187e-09],
       [9.37200000e-03, 9.99576477e-01, 7.71161158e-09],
       [9.67100000e-03, 9.99576439e-01, 8.74382675e-09],
       [9.97000000e-03, 9.99576433e-01, 9.87635385e-09],
       [1.02690000e-02, 9.99576484e-01, 1.11154909e-08],
       [1.05680000e-02, 9.99576511e-01, 1.24677263e-08],
       [1.08670000e-02, 9.99576495e-01, 1.39397410e-08],
       [1.11660000e-02, 9.99576478e-01, 1.55384080e-08],
       [1.14650000e-02, 9.99576413e-01, 1.72707913e-08],
       [1.17640000e-02, 9.99576434e-01, 1.91441493e-08],
       [1.20630000e-02, 9.99576456e-01, 2.11659287e-08],
       [1.23620000e-02, 9.99576496e-01, 2.33437698e-08],
       [1.26610000e-02, 9.99576448e-01, 2.56855015e-08],
       [1.29600000e-02, 9.99576474e-01, 2.81991510e-08],
       [1.32590000e-02, 9.99576471e-01, 3.08929305e-08],
       [1.35580000e-02, 9.99576475e-01, 3.37752478e-08],
       [1.38570000e-02, 9.98515131e-01, 3.68155691e-08],
       [1.41560000e-02, 9.84278548e-01, 3.95257606e-08],
       [1.44550000e-02, 8.87795239e-01, 3.87601274e-08],
       [1.47540000e-02, 6.97272706e-01, 3.30401326e-08],
       [1.50530000e-02, 4.76460780e-01, 2.44635458e-08],
       [1.53520000e-02, 3.33875105e-01, 1.85457279e-08],
       [1.56510000e-02, 2.54317752e-01, 1.52596665e-08],
       [1.59500000e-02, 2.03905036e-01, 1.31968628e-08],
       [1.62490000e-02, 1.67707511e-01, 1.16911994e-08],
       [1.65480000e-02, 1.39773002e-01, 1.04810633e-08],
       [1.68470000e-02, 1.17361479e-01, 9.45400605e-09],
       [1.71460000e-02, 9.89334042e-02, 8.55055354e-09],
       [1.74450000e-02, 8.35342953e-02, 7.73657444e-09],
       [1.77440000e-02, 7.05317134e-02, 6.99182499e-09],
       [1.80430000e-02, 5.94842283e-02, 6.30429937e-09],
       [1.83420000e-02, 5.00698059e-02, 5.66712333e-09],
       [1.86410000e-02, 4.20441210e-02, 5.07670704e-09],
       [1.89400000e-02, 3.52151055e-02, 4.53157208e-09],
       [1.92390000e-02, 2.94268620e-02, 4.03156746e-09],
       [1.95380000e-02, 2.45492423e-02, 3.57732596e-09],
       [1.98370000e-02, 2.04709350e-02, 3.16987147e-09],
       [2.01360000e-02, 1.70948406e-02, 2.81033354e-09],
       [2.04350000e-02, 1.43349067e-02, 2.49973194e-09],
       [2.07340000e-02, 1.21139976e-02, 2.23882351e-09],
       [2.10330000e-02, 1.03623820e-02, 2.02798381e-09],
       [2.13320000e-02, 9.01670393e-03, 1.86712808e-09],
       [2.16310000e-02, 8.01925497e-03, 1.75565999e-09],
       [2.19300000e-02, 7.31743035e-03, 1.69243939e-09],
       [2.22290000e-02, 6.86334598e-03, 1.67577457e-09],
       [2.25280000e-02, 6.61352749e-03, 1.70342773e-09],
       [2.28270000e-02, 6.52865898e-03, 1.77263508e-09],
       [2.31260000e-02, 6.57336895e-03, 1.88013959e-09],
       [2.34250000e-02, 6.71603202e-03, 2.02223283e-09],
       [2.37240000e-02, 6.92858337e-03, 2.19480585e-09],
       [2.40230000e-02, 7.18633332e-03, 2.39340571e-09],
       [2.43220000e-02, 7.46778843e-03, 2.61329924e-09],
       [2.46210000e-02, 7.75446783e-03, 2.84953996e-09],
       [2.49200000e-02, 8.03071845e-03, 3.09703813e-09],
       [2.52190000e-02, 8.28353270e-03, 3.35063436e-09],
       [2.55180000e-02, 8.50235920e-03, 3.60517193e-09],
       [2.58170000e-02, 8.67892138e-03, 3.85557231e-09],
       [2.61160000e-02, 8.80702891e-03, 4.09690659e-09],
       [2.64150000e-02, 8.88239768e-03, 4.32446786e-09],
       [2.67140000e-02, 8.90246883e-03, 4.53383957e-09],
       [2.70130000e-02, 8.86622930e-03, 4.72095905e-09],
       [2.73120000e-02, 8.77404202e-03, 4.88217930e-09],
       [2.76110000e-02, 8.62747524e-03, 5.01432253e-09],
       [2.79100000e-02, 8.42913900e-03, 5.11472822e-09],
       [2.82090000e-02, 8.18252866e-03, 5.18129475e-09],
       [2.85080000e-02, 7.89187080e-03, 5.21251079e-09],
       [2.88070000e-02, 7.56197933e-03, 5.20748007e-09],
       [2.91060000e-02, 7.19811864e-03, 5.16593694e-09],
       [2.94050000e-02, 6.80587000e-03, 5.08824933e-09],
       [2.97040000e-02, 6.39101131e-03, 4.97541523e-09],
       [3.00030000e-02, 5.95940240e-03, 4.82904708e-09],
       [3.03020000e-02, 5.51688037e-03, 4.65134702e-09],
       [3.06010000e-02, 5.06916183e-03, 4.44507028e-09],
       [3.09000000e-02, 4.62175783e-03, 4.21348162e-09],
       [3.11990000e-02, 4.17989681e-03, 3.96030156e-09],
       [3.14980000e-02, 3.74845760e-03, 3.68964444e-09],
       [3.17970000e-02, 3.33191298e-03, 3.40594976e-09],
       [3.20960000e-02, 2.93428375e-03, 3.11390783e-09],
       [3.23950000e-02, 2.55910198e-03, 2.81837988e-09],
       [3.26940000e-02, 2.20938506e-03, 2.52431556e-09],
       [3.29930000e-02, 1.88761809e-03, 2.23666715e-09],
       [3.32920000e-02, 1.59574771e-03, 1.96030557e-09],
       [3.35910000e-02, 1.33518301e-03, 1.69993584e-09],
       [3.38900000e-02, 1.10680548e-03, 1.46001587e-09],
       [3.41890000e-02, 9.10985381e-04, 1.24467796e-09],
       [3.44880000e-02, 7.47607030e-04, 1.05765838e-09],
       [3.47870000e-02, 6.16097999e-04, 9.02230921e-10],
       [3.50860000e-02, 5.15464894e-04, 7.81150165e-10],
       [3.53850000e-02, 4.44333329e-04, 6.96603560e-10],
       [3.56840000e-02, 4.00990367e-04, 6.50171701e-10],
       [3.59830000e-02, 3.83430776e-04, 6.42800853e-10],
       [3.62820000e-02, 3.89404347e-04, 6.74785391e-10],
       [3.65810000e-02, 4.16463906e-04, 7.45760990e-10],
       [3.68800000e-02, 4.62014177e-04, 8.54710327e-10],
       [3.71790000e-02, 5.23359049e-04, 9.99978253e-10],
       [3.74780000e-02, 5.97748060e-04, 1.17929865e-09],
       [3.77770000e-02, 6.82420729e-04, 1.38983126e-09],
       [3.80760000e-02, 7.74648307e-04, 1.62820787e-09],
       [3.83750000e-02, 8.71772916e-04, 1.89058813e-09],
       [3.86740000e-02, 9.71242580e-04, 2.17272162e-09],
       [3.89730000e-02, 1.07064323e-03, 2.47001803e-09],
       [3.92720000e-02, 1.16772666e-03, 2.77762283e-09],
       [3.95710000e-02, 1.26043402e-03, 3.09049624e-09],
       [3.98700000e-02, 1.34691565e-03, 3.40349677e-09],
       [4.01690000e-02, 1.42554621e-03, 3.71146509e-09],
       [4.04680000e-02, 1.49493616e-03, 4.00930976e-09],
       [4.07670000e-02, 1.55393835e-03, 4.29208977e-09],
       [4.10660000e-02, 1.60165184e-03, 4.55509803e-09],
       [4.13650000e-02, 1.63742085e-03, 4.79393820e-09],
       [4.16640000e-02, 1.66083054e-03, 5.00459770e-09],
       [4.19630000e-02, 1.67169981e-03, 5.18351559e-09],
       [4.22620000e-02, 1.67007073e-03, 5.32764217e-09],
       [4.25610000e-02, 1.65619548e-03, 5.43449119e-09],
       [4.28600000e-02, 1.63052047e-03, 5.50218162e-09],
       [4.31590000e-02, 1.59366947e-03, 5.52947308e-09],
       [4.34580000e-02, 1.54642369e-03, 5.51578635e-09],
       [4.37570000e-02, 1.48970176e-03, 5.46121769e-09],
       [4.40560000e-02, 1.42453786e-03, 5.36653852e-09],
       [4.43550000e-02, 1.35205998e-03, 5.23318747e-09],
       [4.46540000e-02, 1.27346703e-03, 5.06324774e-09],
       [4.49530000e-02, 1.19000700e-03, 4.85941778e-09],
       [4.52520000e-02, 1.10295449e-03, 4.62496772e-09],
       [4.55510000e-02, 1.01358990e-03, 4.36369047e-09],
       [4.58500000e-02, 9.23178695e-04, 4.07984002e-09],
       [4.61490000e-02, 8.32952329e-04, 3.77806413e-09],
       [4.64480000e-02, 7.44090608e-04, 3.46333017e-09],
       [4.67470000e-02, 6.57705495e-04, 3.14084461e-09],
       [4.70460000e-02, 5.74826778e-04, 2.81596860e-09],
       [4.73450000e-02, 4.96389408e-04, 2.49412945e-09],
       [4.76440000e-02, 4.23223419e-04, 2.18073330e-09],
       [4.79430000e-02, 3.56045329e-04, 1.88107503e-09],
       [4.82420000e-02, 2.95452011e-04, 1.60025122e-09],
       [4.85410000e-02, 2.41916501e-04, 1.34307532e-09],
       [4.88400000e-02, 1.95785957e-04, 1.11399735e-09],
       [4.91390000e-02, 1.57281697e-04, 9.17029787e-10],
       [4.94380000e-02, 1.26501003e-04, 7.55679329e-10],
       [4.97370000e-02, 1.03420960e-04, 6.32888073e-10],
       [5.00360000e-02, 8.79037955e-05, 5.50982700e-10],
       [5.03350000e-02, 7.97038261e-05, 5.11634076e-10],
       [5.06340000e-02, 7.84758075e-05, 5.15827798e-10],
       [5.09330000e-02, 8.37843405e-05, 5.63845196e-10],
       [5.12320000e-02, 9.51143844e-05, 6.55256658e-10],
       [5.15310000e-02, 1.11882435e-04, 7.88925859e-10],
       [5.18300000e-02, 1.33448349e-04, 9.63026064e-10],
       [5.21290000e-02, 1.59127490e-04, 1.17506743e-09],
       [5.24280000e-02, 1.88203053e-04, 1.42193527e-09],
       [5.27270000e-02, 2.19938409e-04, 1.69993896e-09],
       [5.30260000e-02, 2.53589126e-04, 2.00486944e-09],
       [5.33250000e-02, 2.88414733e-04, 2.33206633e-09],
       [5.36240000e-02, 3.23689848e-04, 2.67649172e-09],
       [5.39230000e-02, 3.58714654e-04, 3.03281070e-09],
       [5.42220000e-02, 3.92824534e-04, 3.39547655e-09],
       [5.45210000e-02, 4.25398782e-04, 3.75881970e-09],
       [5.48200000e-02, 4.55868292e-04, 4.11713882e-09],
       [5.51190000e-02, 4.83722257e-04, 4.46479363e-09],
       [5.54180000e-02, 5.08513436e-04, 4.79629433e-09],
       [5.57170000e-02, 5.29862570e-04, 5.10639186e-09],
       [5.60160000e-02, 5.47461412e-04, 5.39016286e-09],
       [5.63150000e-02, 5.61074592e-04, 5.64308973e-09],
       [5.66140000e-02, 5.70540351e-04, 5.86113503e-09],
       [5.69130000e-02, 5.75769982e-04, 6.04080664e-09],
       [5.72120000e-02, 5.76746584e-04, 6.17921848e-09],
       [5.75110000e-02, 5.73522129e-04, 6.27413496e-09],
       [5.78100000e-02, 5.66214338e-04, 6.32401280e-09],
       [5.81090000e-02, 5.55002050e-04, 6.32802511e-09],
       [5.84080000e-02, 5.40120329e-04, 6.28607945e-09],
       [5.87070000e-02, 5.21854533e-04, 6.19881981e-09],
       [5.90060000e-02, 5.00534114e-04, 6.06762011e-09],
       [5.93050000e-02, 4.76525803e-04, 5.89456367e-09],
       [5.96040000e-02, 4.50226604e-04, 5.68241277e-09],
       [5.99030000e-02, 4.22056536e-04, 5.43456668e-09],
       [6.02020000e-02, 3.92451286e-04, 5.15500908e-09],
       [6.05010000e-02, 3.61854928e-04, 4.84824662e-09],
       [6.08000000e-02, 3.30712644e-04, 4.51923699e-09],
       [6.10990000e-02, 2.99464015e-04, 4.17331390e-09],
       [6.13980000e-02, 2.68536205e-04, 3.81609998e-09],
       [6.16970000e-02, 2.38337908e-04, 3.45341930e-09],
       [6.19960000e-02, 2.09253685e-04, 3.09120490e-09],
       [6.22950000e-02, 1.81638817e-04, 2.73540367e-09],
       [6.25940000e-02, 1.55814848e-04, 2.39188151e-09],
       [6.28930000e-02, 1.32065782e-04, 2.06632938e-09],
       [6.31920000e-02, 1.10635003e-04, 1.76417212e-09],
       [6.34910000e-02, 9.17228604e-05, 1.49048037e-09],
       [6.37900000e-02, 7.54850794e-05, 1.24988923e-09],
       [6.40890000e-02, 6.20318294e-05, 1.04652250e-09],
       [6.43880000e-02, 5.14276111e-05, 8.83926374e-10],
       [6.46870000e-02, 4.36917144e-05, 7.65010027e-10],
       [6.49860000e-02, 3.87994748e-05, 6.91998370e-10],
       [6.52850000e-02, 3.66840995e-05, 6.66394642e-10],
       [6.55840000e-02, 3.72390672e-05, 6.88954273e-10],
       [6.58830000e-02, 4.03210994e-05, 7.59671497e-10],
       [6.61820000e-02, 4.57535338e-05, 8.77776990e-10],
       [6.64810000e-02, 5.33301273e-05, 1.04174828e-09],
       [6.67800000e-02, 6.28191870e-05, 1.24933231e-09],
       [6.70790000e-02, 7.39679347e-05, 1.49757924e-09],
       [6.73780000e-02, 8.65070547e-05, 1.78288770e-09],
       [6.76770000e-02, 1.00155337e-04, 2.10106018e-09],
       [6.79760000e-02, 1.14624361e-04, 2.44736840e-09],
       [6.82750000e-02, 1.29623105e-04, 2.81662647e-09],
       [6.85740000e-02, 1.44862509e-04, 3.20327287e-09],
       [6.88730000e-02, 1.60059764e-04, 3.60145650e-09],
       [6.91720000e-02, 1.74942437e-04, 4.00512895e-09],
       [6.94710000e-02, 1.89252311e-04, 4.40814015e-09],
       [6.97700000e-02, 2.02748810e-04, 4.80433415e-09],
       [7.00690000e-02, 2.15212126e-04, 5.18764700e-09],
       [7.03680000e-02, 2.26445920e-04, 5.55220292e-09],
       [7.06670000e-02, 2.36279498e-04, 5.89240593e-09],
       [7.09660000e-02, 2.44569662e-04, 6.20303015e-09],
       [7.12650000e-02, 2.51201982e-04, 6.47930194e-09],
       [7.15640000e-02, 2.56091622e-04, 6.71697604e-09],
       [7.18630000e-02, 2.59183762e-04, 6.91240479e-09],
       [7.21620000e-02, 2.60453370e-04, 7.06259377e-09],
       [7.24610000e-02, 2.59904808e-04, 7.16525426e-09],
       [7.27600000e-02, 2.57570713e-04, 7.21883710e-09],
       [7.30590000e-02, 2.53510703e-04, 7.22256059e-09],
       [7.33580000e-02, 2.47809630e-04, 7.17642430e-09],
       [7.36570000e-02, 2.40575463e-04, 7.08120937e-09],
       [7.39560000e-02, 2.31937009e-04, 6.93846988e-09],
       [7.42550000e-02, 2.22041257e-04, 6.75050849e-09],
       [7.45540000e-02, 2.11050623e-04, 6.52034292e-09],
       [7.48530000e-02, 1.99139992e-04, 6.25165969e-09],
       [7.51520000e-02, 1.86493691e-04, 5.94875818e-09],
       [7.54510000e-02, 1.73302393e-04, 5.61648445e-09],
       [7.57500000e-02, 1.59760030e-04, 5.26015670e-09],
       [7.60490000e-02, 1.46060709e-04, 4.88548219e-09],
       [7.63480000e-02, 1.32395816e-04, 4.49847093e-09],
       [7.66470000e-02, 1.18951111e-04, 4.10534015e-09],
       [7.69460000e-02, 1.05904103e-04, 3.71241894e-09],
       [7.72450000e-02, 9.34215858e-05, 3.32604978e-09],
       [7.75440000e-02, 8.16573710e-05, 2.95248835e-09],
       [7.78430000e-02, 7.07503744e-05, 2.59780771e-09],
       [7.81420000e-02, 6.08228794e-05, 2.26780165e-09],
       [7.84410000e-02, 5.19791795e-05, 1.96789493e-09],
       [7.87400000e-02, 4.43044909e-05, 1.70305782e-09],
       [7.90390000e-02, 3.78641881e-05, 1.47772764e-09],
       [7.93380000e-02, 3.27033742e-05, 1.29573908e-09],
       [7.96370000e-02, 2.88467695e-05, 1.16026382e-09],
       [7.99360000e-02, 2.62988830e-05, 1.07375933e-09],
       [8.02350000e-02, 2.50445121e-05, 1.03792985e-09],
       [8.05340000e-02, 2.50495240e-05, 1.05369898e-09],
       [8.08330000e-02, 2.62618749e-05, 1.12119336e-09],
       [8.11320000e-02, 2.86128961e-05, 1.23973980e-09],
       [8.14310000e-02, 3.20187821e-05, 1.40787430e-09],
       [8.17300000e-02, 3.63822631e-05, 1.62336324e-09],
       [8.20290000e-02, 4.15944453e-05, 1.88323712e-09],
       [8.23280000e-02, 4.75367508e-05, 2.18383466e-09],
       [8.26270000e-02, 5.40829798e-05, 2.52085898e-09],
       [8.29260000e-02, 6.11013980e-05, 2.88944223e-09],
       [8.32250000e-02, 6.84568803e-05, 3.28422059e-09],
       [8.35240000e-02, 7.60130239e-05, 3.69941581e-09],
       [8.38230000e-02, 8.36342296e-05, 4.12892373e-09],
       [8.41220000e-02, 9.11877178e-05, 4.56640792e-09],
       [8.44210000e-02, 9.85454464e-05, 5.00539701e-09],
       [8.47200000e-02, 1.05585887e-04, 5.43938328e-09],
       [8.50190000e-02, 1.12195717e-04, 5.86192487e-09],
       [8.53180000e-02, 1.18271250e-04, 6.26674254e-09],
       [8.56170000e-02, 1.23719756e-04, 6.64781738e-09],
       [8.59160000e-02, 1.28460574e-04, 6.99948450e-09],
       [8.62150000e-02, 1.32425976e-04, 7.31651912e-09],
       [8.65140000e-02, 1.35561865e-04, 7.59421878e-09],
       [8.68130000e-02, 1.37828222e-04, 7.82847574e-09],
       [8.71120000e-02, 1.39199328e-04, 8.01584069e-09],
       [8.74110000e-02, 1.39663802e-04, 8.15357774e-09],
       [8.77100000e-02, 1.39224383e-04, 8.23970657e-09],
       [8.80090000e-02, 1.37897529e-04, 8.27303442e-09],
       [8.83080000e-02, 1.35712828e-04, 8.25317578e-09],
       [8.86070000e-02, 1.32712234e-04, 8.18056104e-09],
       [8.89060000e-02, 1.28949099e-04, 8.05642926e-09],
       [8.92050000e-02, 1.24487112e-04, 7.88281226e-09],
       [8.95040000e-02, 1.19399094e-04, 7.66250568e-09],
       [8.98030000e-02, 1.13765663e-04, 7.39902651e-09],
       [9.01020000e-02, 1.07673880e-04, 7.09656343e-09],
       [9.04010000e-02, 1.01215733e-04, 6.75991075e-09],
       [9.07000000e-02, 9.44867132e-05, 6.39440133e-09],
       [9.09990000e-02, 8.75842572e-05, 6.00582302e-09],
       [9.12980000e-02, 8.06062880e-05, 5.60033462e-09],
       [9.15970000e-02, 7.36497283e-05, 5.18437191e-09],
       [9.18960000e-02, 6.68090841e-05, 4.76455067e-09],
       [9.21950000e-02, 6.01751139e-05, 4.34756812e-09],
       [9.24940000e-02, 5.38335547e-05, 3.94010054e-09],
       [9.27930000e-02, 4.78639883e-05, 3.54870376e-09],
       [9.30920000e-02, 4.23387883e-05, 3.17971260e-09],
       [9.33910000e-02, 3.73222284e-05, 2.83914563e-09],
       [9.36900000e-02, 3.28697235e-05, 2.53261402e-09],
       [9.39890000e-02, 2.90271992e-05, 2.26523492e-09],
       [9.42880000e-02, 2.58306499e-05, 2.04155473e-09],
       [9.45870000e-02, 2.33058192e-05, 1.86547820e-09],
       [9.48860000e-02, 2.14680664e-05, 1.74020930e-09],
       [9.51850000e-02, 2.03223625e-05, 1.66820052e-09],
       [9.54840000e-02, 1.98634565e-05, 1.65111468e-09],
       [9.57830000e-02, 2.00761826e-05, 1.68979833e-09],
       [9.60820000e-02, 2.09358950e-05, 1.78426628e-09],
       [9.63810000e-02, 2.24090466e-05, 1.93369997e-09],
       [9.66800000e-02, 2.44538716e-05, 2.13645719e-09],
       [9.69790000e-02, 2.70211760e-05, 2.39009439e-09],
       [9.72780000e-02, 3.00552230e-05, 2.69140148e-09],
       [9.75770000e-02, 3.34946799e-05, 3.03644681e-09],
       [9.78760000e-02, 3.72736463e-05, 3.42063495e-09],
       [9.81750000e-02, 4.13226955e-05, 3.83877169e-09],
       [9.84740000e-02, 4.55699717e-05, 4.28514059e-09],
       [9.87730000e-02, 4.99422956e-05, 4.75358736e-09],
       [9.90720000e-02, 5.43662330e-05, 5.23760766e-09],
       [9.93710000e-02, 5.87691860e-05, 5.73044458e-09],
       [9.96700000e-02, 6.30804238e-05, 6.22518748e-09],
       [9.99690000e-02, 6.72320611e-05, 6.71487321e-09],
       [1.00268000e-01, 7.11599956e-05, 7.19259028e-09],
       [1.00567000e-01, 7.48047580e-05, 7.65158138e-09],
       [1.00866000e-01, 7.81122643e-05, 8.08534250e-09],
       [1.01165000e-01, 8.10345060e-05, 8.48772172e-09],
       [1.01464000e-01, 8.35301091e-05, 8.85301023e-09],
       [1.01763000e-01, 8.55648117e-05, 9.17602959e-09],
       [1.02062000e-01, 8.71118113e-05, 9.45220957e-09],
       [1.02361000e-01, 8.81519919e-05, 9.67765666e-09],
       [1.02660000e-01, 8.86740892e-05, 9.84921858e-09],
       [1.02959000e-01, 8.86746556e-05, 9.96452896e-09],
       [1.03258000e-01, 8.81580057e-05, 1.00220506e-08],
       [1.03557000e-01, 8.71359730e-05, 1.00210984e-08],
       [1.03856000e-01, 8.56276232e-05, 9.96185593e-09],
       [1.04155000e-01, 8.36588420e-05, 9.84537680e-09],
       [1.04454000e-01, 8.12618470e-05, 9.67357474e-09],
       [1.04753000e-01, 7.84745976e-05, 9.44919857e-09],
       [1.05052000e-01, 7.53401722e-05, 9.17579936e-09],
       [1.05351000e-01, 7.19060478e-05, 8.85768167e-09],
       [1.05650000e-01, 6.82233656e-05, 8.49984773e-09],
       [1.05949000e-01, 6.43461257e-05, 8.10792739e-09],
       [1.06248000e-01, 6.03303698e-05, 7.68810033e-09],
       [1.06547000e-01, 5.62333754e-05, 7.24701327e-09],
       [1.06846000e-01, 5.21127962e-05, 6.79168366e-09],
       [1.07145000e-01, 4.80258539e-05, 6.32940276e-09],
       [1.07444000e-01, 4.40285408e-05, 5.86763331e-09],
       [1.07743000e-01, 4.01748297e-05, 5.41390087e-09],
       [1.08042000e-01, 3.65159701e-05, 4.97568986e-09],
       [1.08341000e-01, 3.30997864e-05, 4.56033294e-09],
       [1.08640000e-01, 2.99700673e-05, 4.17490643e-09],
       [1.08939000e-01, 2.71660083e-05, 3.82612687e-09],
       [1.09238000e-01, 2.47217287e-05, 3.52025234e-09],
       [1.09537000e-01, 2.26658651e-05, 3.26298944e-09],
       [1.09836000e-01, 2.10212512e-05, 3.05940798e-09],
       [1.10135000e-01, 1.98046748e-05, 2.91386308e-09],
       [1.10434000e-01, 1.90267294e-05, 2.82992778e-09],
       [1.10733000e-01, 1.86917487e-05, 2.81033569e-09],
       [1.11032000e-01, 1.87978228e-05, 2.85693397e-09],
       [1.11331000e-01, 1.93369138e-05, 2.97065079e-09],
       [1.11630000e-01, 2.02950352e-05, 3.15147240e-09],
       [1.11929000e-01, 2.16525265e-05, 3.39843582e-09],
       [1.12228000e-01, 2.33843894e-05, 3.70963285e-09],
       [1.12527000e-01, 2.54606960e-05, 4.08222778e-09],
       [1.12826000e-01, 2.78470644e-05, 4.51248930e-09],
       [1.13125000e-01, 3.05051727e-05, 4.99583237e-09],
       [1.13424000e-01, 3.33933417e-05, 5.52687596e-09],
       [1.13723000e-01, 3.64671369e-05, 6.09950932e-09],
       [1.14022000e-01, 3.96800097e-05, 6.70697036e-09],
       [1.14321000e-01, 4.29839649e-05, 7.34193493e-09],
       [1.14620000e-01, 4.63302171e-05, 7.99661066e-09],
       [1.14919000e-01, 4.96698932e-05, 8.66284570e-09],
       [1.15218000e-01, 5.29546787e-05, 9.33223501e-09],
       [1.15517000e-01, 5.61374884e-05, 9.99623794e-09],
       [1.15816000e-01, 5.91730945e-05, 1.06462958e-08],
       [1.16115000e-01, 6.20187428e-05, 1.12739541e-08],
       [1.16414000e-01, 6.46347043e-05, 1.18709811e-08],
       [1.16713000e-01, 6.69848046e-05, 1.24294876e-08],
       [1.17012000e-01, 6.90368957e-05, 1.29420438e-08],
       [1.17311000e-01, 7.07632675e-05, 1.34017905e-08],
       [1.17610000e-01, 7.21410019e-05, 1.38025449e-08],
       [1.17909000e-01, 7.31522633e-05, 1.41388990e-08],
       [1.18208000e-01, 7.37845135e-05, 1.44063080e-08],
       [1.18507000e-01, 7.40306652e-05, 1.46011704e-08],
       [1.18806000e-01, 7.38891620e-05, 1.47208958e-08],
       [1.19105000e-01, 7.33639736e-05, 1.47639586e-08],
       [1.19404000e-01, 7.24645408e-05, 1.47299424e-08],
       [1.19703000e-01, 7.12056296e-05, 1.46195657e-08],
       [1.20002000e-01, 6.96071297e-05, 1.44346967e-08],
       [1.20301000e-01, 6.76937812e-05, 1.41783510e-08],
       [1.20600000e-01, 6.54948465e-05, 1.38546755e-08],
       [1.20899000e-01, 6.30437064e-05, 1.34689138e-08],
       [1.21198000e-01, 6.03774325e-05, 1.30273612e-08],
       [1.21497000e-01, 5.75362877e-05, 1.25373011e-08],
       [1.21796000e-01, 5.45631977e-05, 1.20069283e-08],
       [1.22095000e-01, 5.15031827e-05, 1.14452579e-08],
       [1.22394000e-01, 4.84027719e-05, 1.08620237e-08],
       [1.22693000e-01, 4.53093847e-05, 1.02675614e-08],
       [1.22992000e-01, 4.22707146e-05, 9.67268499e-09],
       [1.23291000e-01, 3.93340902e-05, 9.08855020e-09],
       [1.23590000e-01, 3.65458591e-05, 8.52651391e-09],
       [1.23889000e-01, 3.39507611e-05, 7.99798351e-09],
       [1.24188000e-01, 3.15913407e-05, 7.51426642e-09],
       [1.24487000e-01, 2.95073720e-05, 7.08641425e-09],
       [1.24786000e-01, 2.77353126e-05, 6.72506551e-09],
       [1.25085000e-01, 2.63078108e-05, 6.44029323e-09],
       [1.25384000e-01, 2.52532441e-05, 6.24145235e-09],
       [1.25683000e-01, 2.45953143e-05, 6.13703402e-09],
       [1.25982000e-01, 2.43526996e-05, 6.13452735e-09],
       [1.26281000e-01, 2.45387653e-05, 6.24028976e-09],
       [1.26580000e-01, 2.51613338e-05, 6.45942746e-09],
       [1.26879000e-01, 2.62225379e-05, 6.79569236e-09],
       [1.27178000e-01, 2.77187255e-05, 7.25138929e-09],
       [1.27477000e-01, 2.96404459e-05, 7.82730165e-09],
       [1.27776000e-01, 3.19725104e-05, 8.52263505e-09],
       [1.28075000e-01, 3.46941189e-05, 9.33497848e-09],
       [1.28374000e-01, 3.77790672e-05, 1.02602874e-08],
       [1.28673000e-01, 4.11960163e-05, 1.12928856e-08],
       [1.28972000e-01, 4.49088350e-05, 1.24254901e-08],
       [1.29271000e-01, 4.88770083e-05, 1.36492582e-08],
       [1.29570000e-01, 5.30561143e-05, 1.49538588e-08],
       [1.29869000e-01, 5.73983389e-05, 1.63275608e-08],
       [1.30168000e-01, 6.18530665e-05, 1.77573504e-08],
       [1.30467000e-01, 6.63674981e-05, 1.92290643e-08],
       [1.30766000e-01, 7.08873344e-05, 2.07275515e-08],
       [1.31065000e-01, 7.53574559e-05, 2.22368443e-08],
       [1.31364000e-01, 7.97226672e-05, 2.37403587e-08],
       [1.31663000e-01, 8.39284464e-05, 2.52211085e-08],
       [1.31962000e-01, 8.79216868e-05, 2.66619290e-08],
       [1.32261000e-01, 9.16514739e-05, 2.80457244e-08],
       [1.32560000e-01, 9.50698639e-05, 2.93557279e-08],
       [1.32859000e-01, 9.81325593e-05, 3.05757446e-08],
       [1.33158000e-01, 1.00799722e-04, 3.16904487e-08],
       [1.33457000e-01, 1.03036599e-04, 3.26856365e-08],
       [1.33756000e-01, 1.04814207e-04, 3.35485105e-08],
       [1.34055000e-01, 1.06109945e-04, 3.42679524e-08],
       [1.34354000e-01, 1.06908135e-04, 3.48347869e-08],
       [1.34653000e-01, 1.07200549e-04, 3.52420486e-08],
       [1.34952000e-01, 1.06986806e-04, 3.54852218e-08],
       [1.35251000e-01, 1.06274771e-04, 3.55624863e-08],
       [1.35550000e-01, 1.05080797e-04, 3.54749217e-08],
       [1.35849000e-01, 1.03429957e-04, 3.52267136e-08],
       [1.36148000e-01, 1.01356142e-04, 3.48253217e-08],
       [1.36447000e-01, 9.89020930e-05, 3.42816288e-08],
       [1.36746000e-01, 9.61193355e-05, 3.36100598e-08],
       [1.37045000e-01, 9.30680136e-05, 3.28286653e-08],
       [1.37344000e-01, 8.98166317e-05, 3.19591728e-08],
       [1.37643000e-01, 8.64417273e-05, 3.10270121e-08],
       [1.37942000e-01, 8.30274190e-05, 3.00612899e-08],
       [1.38241000e-01, 7.96648795e-05, 2.90947326e-08],
       [1.38540000e-01, 7.64517258e-05, 2.81635909e-08],
       [1.38839000e-01, 7.34913166e-05, 2.73074996e-08],
       [1.39138000e-01, 7.08919771e-05, 2.65693001e-08],
       [1.39437000e-01, 6.87661676e-05, 2.59948277e-08],
       [1.39736000e-01, 6.72295456e-05, 2.56326439e-08],
       [1.40035000e-01, 6.64000194e-05, 2.55337492e-08],
       [1.40334000e-01, 6.63967174e-05, 2.57512447e-08],
       [1.40633000e-01, 6.73389243e-05, 2.63399617e-08],
       [1.40932000e-01, 6.93449953e-05, 2.73560623e-08],
       [1.41231000e-01, 7.25312273e-05, 2.88566002e-08],
       [1.41530000e-01, 7.70107512e-05, 3.08990685e-08],
       [1.41829000e-01, 8.28923810e-05, 3.35409051e-08],
       [1.42128000e-01, 9.02794874e-05, 3.68389856e-08],
       [1.42427000e-01, 9.92689226e-05, 4.08491115e-08],
       [1.42726000e-01, 1.09949909e-04, 4.56254596e-08],
       [1.43025000e-01, 1.22403029e-04, 5.12200492e-08],
       [1.43324000e-01, 1.36699228e-04, 5.76821902e-08],
       [1.43623000e-01, 1.52898891e-04, 6.50579405e-08],
       [1.43922000e-01, 1.71051002e-04, 7.33895736e-08],
       [1.44221000e-01, 1.91192312e-04, 8.27150307e-08],
       [1.44520000e-01, 2.13346755e-04, 9.30674582e-08],
       [1.44819000e-01, 2.37524710e-04, 1.04474662e-07],
       [1.45118000e-01, 2.63722640e-04, 1.16958705e-07],
       [1.45417000e-01, 2.91922626e-04, 1.30535453e-07],
       [1.45716000e-01, 3.22092093e-04, 1.45214180e-07],
       [1.46015000e-01, 3.54183715e-04, 1.60997258e-07],
       [1.46314000e-01, 3.88135279e-04, 1.77879808e-07],
       [1.46613000e-01, 4.23869912e-04, 1.95849520e-07],
       [1.46912000e-01, 4.61296104e-04, 2.14886371e-07],
       [1.47211000e-01, 5.00308144e-04, 2.34962537e-07],
       [1.47510000e-01, 5.40786614e-04, 2.56042339e-07],
       [1.47809000e-01, 5.82598839e-04, 2.78082161e-07],
       [1.48108000e-01, 6.25599695e-04, 3.01030568e-07],
       [1.48407000e-01, 6.69632281e-04, 3.24828350e-07],
       [1.48706000e-01, 7.14528904e-04, 3.49408744e-07],
       [1.49005000e-01, 7.60112068e-04, 3.74697672e-07],
       [1.49304000e-01, 8.06195495e-04, 4.00614016e-07],
       [1.49603000e-01, 8.52585352e-04, 4.27070012e-07],
       [1.49902000e-01, 8.99081508e-04, 4.53971694e-07],
       [1.50201000e-01, 9.45478771e-04, 4.81219346e-07],
       [1.50500000e-01, 9.91568330e-04, 5.08708093e-07],
       [1.50799000e-01, 1.03713910e-03, 5.36328473e-07],
       [1.51098000e-01, 1.08197906e-03, 5.63967035e-07],
       [1.51397000e-01, 1.12587696e-03, 5.91507166e-07],
       [1.51696000e-01, 1.16862334e-03, 6.18829591e-07],
       [1.51995000e-01, 1.21001256e-03, 6.45813450e-07],
       [1.52294000e-01, 1.24984378e-03, 6.72336840e-07],
       [1.52593000e-01, 1.28792218e-03, 6.98277530e-07],
       [1.52892000e-01, 1.32406100e-03, 7.23514168e-07],
       [1.53191000e-01, 1.35808238e-03, 7.47926842e-07],
       [1.53490000e-01, 1.38981833e-03, 7.71397772e-07],
       [1.53789000e-01, 1.41911239e-03, 7.93812408e-07],
       [1.54088000e-01, 1.44582095e-03, 8.15060388e-07],
       [1.54387000e-01, 1.46981300e-03, 8.35035613e-07],
       [1.54686000e-01, 1.49097233e-03, 8.53637764e-07],
       [1.54985000e-01, 1.50919788e-03, 8.70772806e-07],
       [1.55284000e-01, 1.52440383e-03, 8.86353310e-07],
       [1.55583000e-01, 1.53652102e-03, 9.00299629e-07],
       [1.55882000e-01, 1.54549670e-03, 9.12540105e-07],
       [1.56181000e-01, 1.55129536e-03, 9.23011878e-07],
       [1.56480000e-01, 1.55389845e-03, 9.31661143e-07],
       [1.56779000e-01, 1.55330450e-03, 9.38443567e-07],
       [1.57078000e-01, 1.54952911e-03, 9.43324669e-07],
       [1.57377000e-01, 1.54260495e-03, 9.46280235e-07],
       [1.57676000e-01, 1.53258084e-03, 9.47296140e-07],
       [1.57975000e-01, 1.51952210e-03, 9.46368935e-07],
       [1.58274000e-01, 1.50350885e-03, 9.43505210e-07],
       [1.58573000e-01, 1.48463658e-03, 9.38722284e-07],
       [1.58872000e-01, 1.46301454e-03, 9.32047604e-07],
       [1.59171000e-01, 1.43876501e-03, 9.23518599e-07],
       [1.59470000e-01, 1.41202261e-03, 9.13182598e-07],
       [1.59769000e-01, 1.38293280e-03, 9.01096174e-07],
       [1.60068000e-01, 1.35165110e-03, 8.87324913e-07],
       [1.60367000e-01, 1.31834185e-03, 8.71942923e-07],
       [1.60666000e-01, 1.28317691e-03, 8.55032185e-07],
       [1.60965000e-01, 1.24633457e-03, 8.36682058e-07],
       [1.61264000e-01, 1.20799808e-03, 8.16988522e-07],
       [1.61563000e-01, 1.16835439e-03, 7.96053454e-07],
       [1.61862000e-01, 1.12759306e-03, 7.73984036e-07],
       [1.62161000e-01, 1.08590465e-03, 7.50891779e-07],
       [1.62460000e-01, 1.04347958e-03, 7.26891764e-07],
       [1.62759000e-01, 1.00050694e-03, 7.02101916e-07],
       [1.63058000e-01, 9.57173345e-04, 6.76642139e-07],
       [1.63357000e-01, 9.13661637e-04, 6.50633449e-07],
       [1.63656000e-01, 8.70149562e-04, 6.24196939e-07],
       [1.63955000e-01, 8.26809392e-04, 5.97453436e-07],
       [1.64254000e-01, 7.83806224e-04, 5.70522171e-07],
       [1.64553000e-01, 7.41297515e-04, 5.43520291e-07],
       [1.64852000e-01, 6.99432179e-04, 5.16562042e-07],
       [1.65151000e-01, 6.58349853e-04, 4.89758039e-07],
       [1.65450000e-01, 6.18180271e-04, 4.63214586e-07],
       [1.65749000e-01, 5.79042708e-04, 4.37033033e-07],
       [1.66048000e-01, 5.41045588e-04, 4.11309230e-07],
       [1.66347000e-01, 5.04286096e-04, 3.86132970e-07],
       [1.66646000e-01, 4.68850019e-04, 3.61587587e-07],
       [1.66945000e-01, 4.34811517e-04, 3.37749492e-07],
       [1.67244000e-01, 4.02233116e-04, 3.14687873e-07],
       [1.67543000e-01, 3.71165793e-04, 2.92464458e-07],
       [1.67842000e-01, 3.41649002e-04, 2.71133225e-07],
       [1.68141000e-01, 3.13711053e-04, 2.50740406e-07],
       [1.68440000e-01, 2.87369279e-04, 2.31324307e-07],
       [1.68739000e-01, 2.62630470e-04, 2.12915361e-07],
       [1.69038000e-01, 2.39491377e-04, 1.95536242e-07],
       [1.69337000e-01, 2.17939127e-04, 1.79201917e-07],
       [1.69636000e-01, 1.97951854e-04, 1.63919894e-07],
       [1.69935000e-01, 1.79499309e-04, 1.49690461e-07],
       [1.70234000e-01, 1.62543521e-04, 1.36506987e-07],
       [1.70533000e-01, 1.47039475e-04, 1.24356266e-07],
       [1.70832000e-01, 1.32935864e-04, 1.13218935e-07],
       [1.71131000e-01, 1.20175813e-04, 1.03069892e-07],
       [1.71430000e-01, 1.08697635e-04, 9.38787707e-08],
       [1.71729000e-01, 9.84355973e-05, 8.56104431e-08],
       [1.72028000e-01, 8.93206619e-05, 7.82255263e-08],
       [1.72327000e-01, 8.12812509e-05, 7.16809395e-08],
       [1.72626000e-01, 7.42439547e-05, 6.59304328e-08],
       [1.72925000e-01, 6.81342608e-05, 6.09251611e-08],
       [1.73224000e-01, 6.28772127e-05, 5.66142206e-08],
       [1.73523000e-01, 5.83980697e-05, 5.29452108e-08],
       [1.73822000e-01, 5.46229090e-05, 4.98647672e-08],
       [1.74121000e-01, 5.14791918e-05, 4.73190842e-08],
       [1.74420000e-01, 4.88962902e-05, 4.52544237e-08],
       [1.74719000e-01, 4.68059539e-05, 4.36175876e-08],
       [1.75018000e-01, 4.51427407e-05, 4.23563754e-08],
       [1.75317000e-01, 4.38443785e-05, 4.14199949e-08],
       [1.75616000e-01, 4.28520918e-05, 4.07594534e-08],
       [1.75915000e-01, 4.21108633e-05, 4.03279026e-08],
       [1.76214000e-01, 4.15696432e-05, 4.00809435e-08],
       [1.76513000e-01, 4.11815185e-05, 3.99769025e-08],
       [1.76812000e-01, 4.09038075e-05, 3.99770444e-08],
       [1.77111000e-01, 4.06981324e-05, 4.00457675e-08],
       [1.77410000e-01, 4.05304199e-05, 4.01507338e-08],
       [1.77709000e-01, 4.03708726e-05, 4.02629720e-08],
       [1.78008000e-01, 4.01938941e-05, 4.03569342e-08],
       [1.78307000e-01, 3.99779788e-05, 4.04105169e-08],
       [1.78606000e-01, 3.97055513e-05, 4.04050276e-08],
       [1.78905000e-01, 3.93627963e-05, 4.03251374e-08],
       [1.79204000e-01, 3.89394490e-05, 4.01587882e-08],
       [1.79503000e-01, 3.84285554e-05, 3.98970609e-08],
       [1.79802000e-01, 3.78262305e-05, 3.95340346e-08],
       [1.80101000e-01, 3.71313917e-05, 3.90666098e-08],
       [1.80400000e-01, 3.63454595e-05, 3.84942885e-08],
       [1.80699000e-01, 3.54721031e-05, 3.78189908e-08],
       [1.80998000e-01, 3.45169180e-05, 3.70447881e-08],
       [1.81297000e-01, 3.34871596e-05, 3.61776858e-08],
       [1.81596000e-01, 3.23914381e-05, 3.52253520e-08],
       [1.81895000e-01, 3.12394434e-05, 3.41968680e-08],
       [1.82194000e-01, 3.00416731e-05, 3.31024698e-08],
       [1.82493000e-01, 2.88091720e-05, 3.19532928e-08],
       [1.82792000e-01, 2.75532817e-05, 3.07611148e-08],
       [1.83091000e-01, 2.62854125e-05, 2.95381154e-08],
       [1.83390000e-01, 2.50168327e-05, 2.82966437e-08],
       [1.83689000e-01, 2.37584748e-05, 2.70489965e-08],
       [1.83988000e-01, 2.25207629e-05, 2.58072121e-08],
       [1.84287000e-01, 2.13134658e-05, 2.45828866e-08],
       [1.84586000e-01, 2.01455626e-05, 2.33869956e-08],
       [1.84885000e-01, 1.90251425e-05, 2.22297525e-08],
       [1.85184000e-01, 1.79593172e-05, 2.11204742e-08],
       [1.85483000e-01, 1.69541589e-05, 2.00674734e-08],
       [1.85782000e-01, 1.60146579e-05, 1.90779717e-08],
       [1.86081000e-01, 1.51447039e-05, 1.81580376e-08],
       [1.86380000e-01, 1.43470797e-05, 1.73125380e-08],
       [1.86679000e-01, 1.36234778e-05, 1.65451173e-08],
       [1.86978000e-01, 1.29745343e-05, 1.58581973e-08],
       [1.87277000e-01, 1.23998703e-05, 1.52529876e-08],
       [1.87576000e-01, 1.18981560e-05, 1.47295250e-08],
       [1.87875000e-01, 1.14671795e-05, 1.42867218e-08],
       [1.88174000e-01, 1.11039256e-05, 1.39224289e-08],
       [1.88473000e-01, 1.08046672e-05, 1.36335190e-08],
       [1.88772000e-01, 1.05650558e-05, 1.34159708e-08],
       [1.89071000e-01, 1.03802229e-05, 1.32649728e-08],
       [1.89370000e-01, 1.02448785e-05, 1.31750274e-08],
       [1.89669000e-01, 1.01534128e-05, 1.31400635e-08],
       [1.89968000e-01, 1.00999977e-05, 1.31535530e-08],
       [1.90267000e-01, 1.00786838e-05, 1.32086278e-08],
       [1.90566000e-01, 1.00834964e-05, 1.32981988e-08],
       [1.90865000e-01, 1.01085240e-05, 1.34150696e-08],
       [1.91164000e-01, 1.01480031e-05, 1.35520510e-08],
       [1.91463000e-01, 1.01963948e-05, 1.37020669e-08],
       [1.91762000e-01, 1.02484538e-05, 1.38582551e-08],
       [1.92061000e-01, 1.02992903e-05, 1.40140623e-08],
       [1.92360000e-01, 1.03444217e-05, 1.41633273e-08],
       [1.92659000e-01, 1.03798154e-05, 1.43003556e-08],
       [1.92958000e-01, 1.04019249e-05, 1.44199870e-08],
       [1.93257000e-01, 1.04077122e-05, 1.45176462e-08],
       [1.93556000e-01, 1.03946650e-05, 1.45893872e-08],
       [1.93855000e-01, 1.03608037e-05, 1.46319253e-08],
       [1.94154000e-01, 1.03046793e-05, 1.46426556e-08],
       [1.94453000e-01, 1.02253649e-05, 1.46196645e-08],
       [1.94752000e-01, 1.01224370e-05, 1.45617238e-08],
       [1.95051000e-01, 9.99595413e-06, 1.44682825e-08],
       [1.95350000e-01, 9.84642633e-06, 1.43394435e-08],
       [1.95649000e-01, 9.67477860e-06, 1.41759302e-08],
       [1.95948000e-01, 9.48231373e-06, 1.39790501e-08],
       [1.96247000e-01, 9.27066824e-06, 1.37506474e-08],
       [1.96546000e-01, 9.04176627e-06, 1.34930496e-08],
       [1.96845000e-01, 8.79777309e-06, 1.32090112e-08],
       [1.97144000e-01, 8.54104398e-06, 1.29016488e-08],
       [1.97443000e-01, 8.27407699e-06, 1.25743783e-08],
       [1.97742000e-01, 7.99946354e-06, 1.22308475e-08],
       [1.98041000e-01, 7.71984026e-06, 1.18748671e-08],
       [1.98340000e-01, 7.43784445e-06, 1.15103446e-08],
       [1.98639000e-01, 7.15607004e-06, 1.11412178e-08],
       [1.98938000e-01, 6.87702696e-06, 1.07713892e-08],
       [1.99237000e-01, 6.60310498e-06, 1.04046668e-08],
       [1.99536000e-01, 6.33653950e-06, 1.00447052e-08],
       [1.99835000e-01, 6.07938467e-06, 9.69495602e-09],
       [2.00134000e-01, 5.83348743e-06, 9.35861904e-09],
       [2.00433000e-01, 5.60046726e-06, 9.03860006e-09],
       [2.00732000e-01, 5.38170125e-06, 8.73747673e-09],
       [2.01031000e-01, 5.17831390e-06, 8.45747076e-09],
       [2.01330000e-01, 4.99117038e-06, 8.20042515e-09],
       [2.01629000e-01, 4.82087402e-06, 7.96778795e-09],
       [2.01928000e-01, 4.66776973e-06, 7.76060535e-09],
       [2.02227000e-01, 4.53195047e-06, 7.57952015e-09],
       [2.02526000e-01, 4.41326583e-06, 7.42477382e-09],
       [2.02825000e-01, 4.31133655e-06, 7.29621905e-09],
       [2.03124000e-01, 4.22557111e-06, 7.19333648e-09],
       [2.03423000e-01, 4.15518315e-06, 7.11525372e-09],
       [2.03722000e-01, 4.09921384e-06, 7.06077381e-09],
       [2.04021000e-01, 4.05655405e-06, 7.02840460e-09],
       [2.04320000e-01, 4.02596804e-06, 7.01639197e-09],
       [2.04619000e-01, 4.00611875e-06, 7.02275714e-09],
       [2.04918000e-01, 3.99559253e-06, 7.04533465e-09],
       [2.05217000e-01, 3.99292441e-06, 7.08181255e-09],
       [2.05516000e-01, 3.99662335e-06, 7.12977419e-09],
       [2.05815000e-01, 4.00519547e-06, 7.18673795e-09],
       [2.06114000e-01, 4.01716747e-06, 7.25019862e-09],
       [2.06413000e-01, 4.03110821e-06, 7.31766696e-09],
       [2.06712000e-01, 4.04564800e-06, 7.38670659e-09],
       [2.07011000e-01, 4.05949700e-06, 7.45497031e-09],
       [2.07310000e-01, 4.07146068e-06, 7.52023221e-09],
       [2.07609000e-01, 4.08045357e-06, 7.58041786e-09],
       [2.07908000e-01, 4.08551069e-06, 7.63363085e-09],
       [2.08207000e-01, 4.08579610e-06, 7.67817481e-09],
       [2.08506000e-01, 4.08060901e-06, 7.71257165e-09],
       [2.08805000e-01, 4.06938887e-06, 7.73557798e-09],
       [2.09104000e-01, 4.05171547e-06, 7.74619279e-09],
       [2.09403000e-01, 4.02730947e-06, 7.74366578e-09],
       [2.09702000e-01, 3.99602915e-06, 7.72749865e-09],
       [2.10001000e-01, 3.95786534e-06, 7.69744271e-09],
       [2.10300000e-01, 3.91293566e-06, 7.65349490e-09],
       [2.10599000e-01, 3.86147510e-06, 7.59588634e-09],
       [2.10898000e-01, 3.80382693e-06, 7.52507086e-09],
       [2.11197000e-01, 3.74043179e-06, 7.44170961e-09],
       [2.11496000e-01, 3.67181555e-06, 7.34665235e-09],
       [2.11795000e-01, 3.59857666e-06, 7.24091703e-09],
       [2.12094000e-01, 3.52137269e-06, 7.12566699e-09],
       [2.12393000e-01, 3.44090758e-06, 7.00218862e-09],
       [2.12692000e-01, 3.35791698e-06, 6.87186431e-09],
       [2.12991000e-01, 3.27315573e-06, 6.73614891e-09],
       [2.13290000e-01, 3.18738500e-06, 6.59654458e-09],
       [2.13589000e-01, 3.10135814e-06, 6.45457200e-09],
       [2.13888000e-01, 3.01581090e-06, 6.31174994e-09],
       [2.14187000e-01, 2.93144923e-06, 6.16956876e-09],
       [2.14486000e-01, 2.84893983e-06, 6.02946914e-09],
       [2.14785000e-01, 2.76890078e-06, 5.89282015e-09],
       [2.15084000e-01, 2.69189459e-06, 5.76090174e-09],
       [2.15383000e-01, 2.61842136e-06, 5.63488713e-09],
       [2.15682000e-01, 2.54891368e-06, 5.51582828e-09],
       [2.15981000e-01, 2.48373278e-06, 5.40464359e-09],
       [2.16280000e-01, 2.42316629e-06, 5.30210912e-09],
       [2.16579000e-01, 2.36742663e-06, 5.20885065e-09],
       [2.16878000e-01, 2.31665128e-06, 5.12533981e-09],
       [2.17177000e-01, 2.27090424e-06, 5.05189295e-09],
       [2.17476000e-01, 2.23017749e-06, 4.98866998e-09],
       [2.17775000e-01, 2.19439529e-06, 4.93567951e-09],
       [2.18074000e-01, 2.16341764e-06, 4.89278266e-09],
       [2.18373000e-01, 2.13704587e-06, 4.85970162e-09],
       [2.18672000e-01, 2.11502805e-06, 4.83602837e-09],
       [2.18971000e-01, 2.09706533e-06, 4.82123575e-09],
       [2.19270000e-01, 2.08281887e-06, 4.81469044e-09],
       [2.19569000e-01, 2.07191652e-06, 4.81566589e-09],
       [2.19868000e-01, 2.06396025e-06, 4.82335729e-09],
       [2.20167000e-01, 2.05853350e-06, 4.83689699e-09],
       [2.20466000e-01, 2.05520815e-06, 4.85536970e-09],
       [2.20765000e-01, 2.05355180e-06, 4.87782873e-09],
       [2.21064000e-01, 2.05313458e-06, 4.90331184e-09],
       [2.21363000e-01, 2.05353527e-06, 4.93085570e-09],
       [2.21662000e-01, 2.05434735e-06, 4.95951109e-09],
       [2.21961000e-01, 2.05518489e-06, 4.98835772e-09],
       [2.22260000e-01, 2.05568687e-06, 5.01651600e-09],
       [2.22559000e-01, 2.05552154e-06, 5.04315919e-09],
       [2.22858000e-01, 2.05439032e-06, 5.06752472e-09],
       [2.23157000e-01, 2.05203033e-06, 5.08892245e-09],
       [2.23456000e-01, 2.04821651e-06, 5.10674232e-09],
       [2.23755000e-01, 2.04276351e-06, 5.12046127e-09],
       [2.24054000e-01, 2.03552619e-06, 5.12964726e-09],
       [2.24353000e-01, 2.02639986e-06, 5.13396227e-09],
       [2.24652000e-01, 2.01531957e-06, 5.13316330e-09],
       [2.24951000e-01, 2.00225932e-06, 5.12710294e-09],
       [2.25250000e-01, 1.98723014e-06, 5.11572703e-09],
       [2.25549000e-01, 1.97027830e-06, 5.09907263e-09],
       [2.25848000e-01, 1.95148213e-06, 5.07726200e-09],
       [2.26147000e-01, 1.93094968e-06, 5.05049888e-09],
       [2.26446000e-01, 1.90881520e-06, 5.01906128e-09],
       [2.26745000e-01, 1.88523537e-06, 4.98329339e-09],
       [2.27044000e-01, 1.86038624e-06, 4.94359900e-09],
       [2.27343000e-01, 1.83445896e-06, 4.90043178e-09],
       [2.27642000e-01, 1.80765601e-06, 4.85428599e-09],
       [2.27941000e-01, 1.78018749e-06, 4.80568768e-09],
       [2.28240000e-01, 1.75226767e-06, 4.75518571e-09],
       [2.28539000e-01, 1.72411070e-06, 4.70334069e-09],
       [2.28838000e-01, 1.69592799e-06, 4.65071773e-09],
       [2.29137000e-01, 1.66792451e-06, 4.59787628e-09],
       [2.29436000e-01, 1.64029603e-06, 4.54536207e-09],
       [2.29735000e-01, 1.61322683e-06, 4.49370019e-09],
       [2.30034000e-01, 1.58688681e-06, 4.44338635e-09],
       [2.30333000e-01, 1.56143007e-06, 4.39488176e-09],
       [2.30632000e-01, 1.53699304e-06, 4.34860701e-09],
       [2.30931000e-01, 1.51369342e-06, 4.30493767e-09],
       [2.31230000e-01, 1.49162921e-06, 4.26420029e-09],
       [2.31529000e-01, 1.47087834e-06, 4.22666994e-09],
       [2.31828000e-01, 1.45149823e-06, 4.19256753e-09],
       [2.32127000e-01, 1.43352637e-06, 4.16205984e-09],
       [2.32426000e-01, 1.41698030e-06, 4.13525833e-09],
       [2.32725000e-01, 1.40185882e-06, 4.11222088e-09],
       [2.33024000e-01, 1.38814268e-06, 4.09295263e-09],
       [2.33323000e-01, 1.37579589e-06, 4.07740841e-09],
       [2.33622000e-01, 1.36476729e-06, 4.06549616e-09],
       [2.33921000e-01, 1.35499180e-06, 4.05707947e-09],
       [2.34220000e-01, 1.34639246e-06, 4.05198266e-09],
       [2.34519000e-01, 1.33888212e-06, 4.04999492e-09],
       [2.34818000e-01, 1.33236503e-06, 4.05087427e-09],
       [2.35117000e-01, 1.32673907e-06, 4.05435381e-09],
       [2.35416000e-01, 1.32189747e-06, 4.06014625e-09],
       [2.35715000e-01, 1.31773049e-06, 4.06794876e-09],
       [2.36014000e-01, 1.31412741e-06, 4.07744898e-09],
       [2.36313000e-01, 1.31097804e-06, 4.08832933e-09],
       [2.36612000e-01, 1.30817436e-06, 4.10027229e-09],
       [2.36911000e-01, 1.30561186e-06, 4.11296477e-09],
       [2.37210000e-01, 1.30319097e-06, 4.12610272e-09],
       [2.37509000e-01, 1.30081816e-06, 4.13939503e-09],
       [2.37808000e-01, 1.29840662e-06, 4.15256617e-09],
       [2.38107000e-01, 1.29587770e-06, 4.16536121e-09],
       [2.38406000e-01, 1.29316084e-06, 4.17754626e-09],
       [2.38705000e-01, 1.29019440e-06, 4.18891181e-09],
       [2.39004000e-01, 1.28692617e-06, 4.19927493e-09],
       [2.39303000e-01, 1.28331294e-06, 4.20847883e-09],
       [2.39602000e-01, 1.27932097e-06, 4.21639484e-09],
       [2.39901000e-01, 1.27492567e-06, 4.22292239e-09],
       [2.40200000e-01, 1.27011133e-06, 4.22798855e-09],
       [2.40499000e-01, 1.26487067e-06, 4.23154753e-09],
       [2.40798000e-01, 1.25920440e-06, 4.23357965e-09],
       [2.41097000e-01, 1.25312080e-06, 4.23409079e-09],
       [2.41396000e-01, 1.24663473e-06, 4.23310946e-09],
       [2.41695000e-01, 1.23976716e-06, 4.23068598e-09],
       [2.41994000e-01, 1.23254440e-06, 4.22689021e-09],
       [2.42293000e-01, 1.22499728e-06, 4.22180912e-09],
       [2.42592000e-01, 1.21716046e-06, 4.21554507e-09],
       [2.42891000e-01, 1.20907161e-06, 4.20821303e-09],
       [2.43190000e-01, 1.20077046e-06, 4.19993768e-09],
       [2.43489000e-01, 1.19229846e-06, 4.19085242e-09],
       [2.43788000e-01, 1.18369778e-06, 4.18109594e-09],
       [2.44087000e-01, 1.17501081e-06, 4.17081052e-09],
       [2.44386000e-01, 1.16627939e-06, 4.16013950e-09],
       [2.44685000e-01, 1.15754444e-06, 4.14922569e-09],
       [2.44984000e-01, 1.14884553e-06, 4.13820999e-09],
       [2.45283000e-01, 1.14022022e-06, 4.12722870e-09],
       [2.45582000e-01, 1.13170387e-06, 4.11641289e-09],
       [2.45881000e-01, 1.12332941e-06, 4.10588718e-09],
       [2.46180000e-01, 1.11512692e-06, 4.09576820e-09],
       [2.46479000e-01, 1.10712358e-06, 4.08616400e-09],
       [2.46778000e-01, 1.09934366e-06, 4.07717390e-09],
       [2.47077000e-01, 1.09180817e-06, 4.06888689e-09],
       [2.47376000e-01, 1.08453512e-06, 4.06138231e-09],
       [2.47675000e-01, 1.07753952e-06, 4.05472957e-09],
       [2.47974000e-01, 1.07083334e-06, 4.04898784e-09],
       [2.48273000e-01, 1.06442560e-06, 4.04420611e-09],
       [2.48572000e-01, 1.05832265e-06, 4.04042376e-09],
       [2.48871000e-01, 1.05252824e-06, 4.03767098e-09],
       [2.49170000e-01, 1.04704353e-06, 4.03596828e-09],
       [2.49469000e-01, 1.04186746e-06, 4.03532781e-09],
       [2.49768000e-01, 1.03699704e-06, 4.03575414e-09],
       [2.50067000e-01, 1.03242707e-06, 4.03724328e-09],
       [2.50366000e-01, 1.02815077e-06, 4.03978460e-09],
       [2.50665000e-01, 1.02415981e-06, 4.04336106e-09],
       [2.50964000e-01, 1.02044432e-06, 4.04794894e-09],
       [2.51263000e-01, 1.01699331e-06, 4.05351943e-09],
       [2.51562000e-01, 1.01379445e-06, 4.06003769e-09],
       [2.51861000e-01, 1.01083476e-06, 4.06746534e-09],
       [2.52160000e-01, 1.00810006e-06, 4.07575830e-09],
       [2.52459000e-01, 1.00557564e-06, 4.08486937e-09],
       [2.52758000e-01, 1.00324600e-06, 4.09474703e-09],
       [2.53057000e-01, 1.00109523e-06, 4.10533698e-09],
       [2.53356000e-01, 9.99106850e-07, 4.11658144e-09],
       [2.53655000e-01, 9.97263936e-07, 4.12841953e-09],
       [2.53954000e-01, 9.95549395e-07, 4.14078845e-09],
       [2.54253000e-01, 9.93945851e-07, 4.15362294e-09],
       [2.54552000e-01, 9.92435685e-07, 4.16685537e-09],
       [2.54851000e-01, 9.91001267e-07, 4.18041674e-09],
       [2.55150000e-01, 9.89625014e-07, 4.19423688e-09],
       [2.55449000e-01, 9.88289374e-07, 4.20824439e-09],
       [2.55748000e-01, 9.86976914e-07, 4.22236700e-09],
       [2.56047000e-01, 9.85670651e-07, 4.23653299e-09],
       [2.56346000e-01, 9.84353799e-07, 4.25067012e-09],
       [2.56645000e-01, 9.83010225e-07, 4.26470766e-09],
       [2.56944000e-01, 9.81624411e-07, 4.27857622e-09],
       [2.57243000e-01, 9.80181423e-07, 4.29220771e-09],
       [2.57542000e-01, 9.78667423e-07, 4.30553762e-09],
       [2.57841000e-01, 9.77069397e-07, 4.31850392e-09],
       [2.58140000e-01, 9.75375618e-07, 4.33104921e-09],
       [2.58439000e-01, 9.73575484e-07, 4.34312008e-09],
       [2.58738000e-01, 9.71659899e-07, 4.35466897e-09],
       [2.59037000e-01, 9.69621192e-07, 4.36565393e-09],
       [2.59336000e-01, 9.67453399e-07, 4.37604004e-09],
       [2.59635000e-01, 9.65152267e-07, 4.38579960e-09],
       [2.59934000e-01, 9.62715270e-07, 4.39491237e-09],
       [2.60233000e-01, 9.60141887e-07, 4.40336707e-09],
       [2.60532000e-01, 9.57433376e-07, 4.41116047e-09],
       [2.60831000e-01, 9.54593046e-07, 4.41829889e-09],
       [2.61130000e-01, 9.51626135e-07, 4.42479786e-09],
       [2.61429000e-01, 9.48539769e-07, 4.43068210e-09],
       [2.61728000e-01, 9.45342978e-07, 4.43598582e-09],
       [2.62027000e-01, 9.42046669e-07, 4.44075278e-09],
       [2.62326000e-01, 9.38663372e-07, 4.44503536e-09],
       [2.62625000e-01, 9.35207190e-07, 4.44889441e-09],
       [2.62924000e-01, 9.31693697e-07, 4.45239904e-09],
       [2.63223000e-01, 9.28139717e-07, 4.45562565e-09],
       [2.63522000e-01, 9.24563081e-07, 4.45865695e-09],
       [2.63821000e-01, 9.20982518e-07, 4.46158155e-09],
       [2.64120000e-01, 9.17417245e-07, 4.46449205e-09],
       [2.64419000e-01, 9.13886939e-07, 4.46748501e-09],
       [2.64718000e-01, 9.10411298e-07, 4.47065885e-09],
       [2.65017000e-01, 9.07009855e-07, 4.47411291e-09],
       [2.65316000e-01, 9.03701613e-07, 4.47794569e-09],
       [2.65615000e-01, 9.00504954e-07, 4.48225433e-09],
       [2.65914000e-01, 8.97437156e-07, 4.48713213e-09],
       [2.66213000e-01, 8.94514323e-07, 4.49266811e-09],
       [2.66512000e-01, 8.91751019e-07, 4.49894504e-09],
       [2.66811000e-01, 8.89160078e-07, 4.50603829e-09],
       [2.67110000e-01, 8.86752481e-07, 4.51401504e-09],
       [2.67409000e-01, 8.84537037e-07, 4.52293245e-09],
       [2.67708000e-01, 8.82520317e-07, 4.53283709e-09],
       [2.68007000e-01, 8.80706523e-07, 4.54376396e-09],
       [2.68306000e-01, 8.79097413e-07, 4.55573591e-09],
       [2.68605000e-01, 8.77692245e-07, 4.56876302e-09],
       [2.68904000e-01, 8.76487740e-07, 4.58284212e-09],
       [2.69203000e-01, 8.75478142e-07, 4.59795683e-09],
       [2.69502000e-01, 8.74655255e-07, 4.61407745e-09],
       [2.69801000e-01, 8.74008523e-07, 4.63116109e-09],
       [2.70100000e-01, 8.73525240e-07, 4.64915253e-09],
       [2.70399000e-01, 8.73190594e-07, 4.66798416e-09],
       [2.70698000e-01, 8.72988002e-07, 4.68757752e-09],
       [2.70997000e-01, 8.72899221e-07, 4.70784373e-09],
       [2.71296000e-01, 8.72904689e-07, 4.72868504e-09],
       [2.71595000e-01, 8.72983742e-07, 4.74999593e-09],
       [2.71894000e-01, 8.73114882e-07, 4.77166434e-09],
       [2.72193000e-01, 8.73276180e-07, 4.79357386e-09],
       [2.72492000e-01, 8.73445511e-07, 4.81560485e-09],
       [2.72791000e-01, 8.73600896e-07, 4.83763639e-09],
       [2.73090000e-01, 8.73720778e-07, 4.85954775e-09],
       [2.73389000e-01, 8.73784441e-07, 4.88122080e-09],
       [2.73688000e-01, 8.73772097e-07, 4.90254056e-09],
       [2.73987000e-01, 8.73665465e-07, 4.92339860e-09],
       [2.74286000e-01, 8.73447758e-07, 4.94369306e-09],
       [2.74585000e-01, 8.73104085e-07, 4.96333120e-09],
       [2.74884000e-01, 8.72621607e-07, 4.98223043e-09],
       [2.75183000e-01, 8.71989705e-07, 5.00031957e-09],
       [2.75482000e-01, 8.71200175e-07, 5.01754023e-09],
       [2.75781000e-01, 8.70247270e-07, 5.03384730e-09],
       [2.76080000e-01, 8.69127860e-07, 5.04921027e-09],
       [2.76379000e-01, 8.67841341e-07, 5.06361292e-09],
       [2.76678000e-01, 8.66389772e-07, 5.07705452e-09],
       [2.76977000e-01, 8.64777743e-07, 5.08954937e-09],
       [2.77276000e-01, 8.63012277e-07, 5.10112652e-09],
       [2.77575000e-01, 8.61102772e-07, 5.11182975e-09],
       [2.77874000e-01, 8.59060829e-07, 5.12171688e-09],
       [2.78173000e-01, 8.56900024e-07, 5.13085867e-09],
       [2.78472000e-01, 8.54635718e-07, 5.13933793e-09],
       [2.78771000e-01, 8.52284843e-07, 5.14724851e-09],
       [2.79070000e-01, 8.49865604e-07, 5.15469368e-09],
       [2.79369000e-01, 8.47397114e-07, 5.16178408e-09],
       [2.79668000e-01, 8.44899323e-07, 5.16863743e-09],
       [2.79967000e-01, 8.42392486e-07, 5.17537542e-09],
       [2.80266000e-01, 8.39896981e-07, 5.18212257e-09],
       [2.80565000e-01, 8.37432895e-07, 5.18900377e-09],
       [2.80864000e-01, 8.35019871e-07, 5.19614327e-09],
       [2.81163000e-01, 8.32676703e-07, 5.20366211e-09],
       [2.81462000e-01, 8.30421018e-07, 5.21167601e-09],
       [2.81761000e-01, 8.28269156e-07, 5.22029455e-09],
       [2.82060000e-01, 8.26235886e-07, 5.22961912e-09],
       [2.82359000e-01, 8.24334096e-07, 5.23974080e-09],
       [2.82658000e-01, 8.22574715e-07, 5.25073962e-09],
       [2.82957000e-01, 8.20966544e-07, 5.26268321e-09],
       [2.83256000e-01, 8.19516136e-07, 5.27562577e-09],
       [2.83555000e-01, 8.18227711e-07, 5.28960719e-09],
       [2.83854000e-01, 8.17103087e-07, 5.30465233e-09],
       [2.84153000e-01, 8.16141705e-07, 5.32077082e-09],
       [2.84452000e-01, 8.15340679e-07, 5.33795708e-09],
       [2.84751000e-01, 8.14694794e-07, 5.35618998e-09],
       [2.85050000e-01, 8.14196680e-07, 5.37543368e-09],
       [2.85349000e-01, 8.13836864e-07, 5.39563767e-09],
       [2.85648000e-01, 8.13604057e-07, 5.41673833e-09],
       [2.85947000e-01, 8.13485119e-07, 5.43865851e-09],
       [2.86246000e-01, 8.13465543e-07, 5.46131049e-09],
       [2.86545000e-01, 8.13529526e-07, 5.48459620e-09],
       [2.86844000e-01, 8.13660206e-07, 5.50840871e-09],
       [2.87143000e-01, 8.13840016e-07, 5.53263441e-09],
       [2.87442000e-01, 8.14050889e-07, 5.55715434e-09],
       [2.87741000e-01, 8.14274565e-07, 5.58184617e-09],
       [2.88040000e-01, 8.14492854e-07, 5.60658599e-09],
       [2.88339000e-01, 8.14687892e-07, 5.63125007e-09],
       [2.88638000e-01, 8.14842460e-07, 5.65571710e-09],
       [2.88937000e-01, 8.14940129e-07, 5.67986928e-09],
       [2.89236000e-01, 8.14965616e-07, 5.70359491e-09],
       [2.89535000e-01, 8.14904937e-07, 5.72678963e-09],
       [2.89834000e-01, 8.14745572e-07, 5.74935772e-09],
       [2.90133000e-01, 8.14476696e-07, 5.77121398e-09],
       [2.90432000e-01, 8.14089242e-07, 5.79228441e-09],
       [2.90731000e-01, 8.13576130e-07, 5.81250804e-09],
       [2.91030000e-01, 8.12932177e-07, 5.83183666e-09],
       [2.91329000e-01, 8.12154302e-07, 5.85023648e-09],
       [2.91628000e-01, 8.11241438e-07, 5.86768787e-09],
       [2.91927000e-01, 8.10194630e-07, 5.88418634e-09],
       [2.92226000e-01, 8.09016810e-07, 5.89974118e-09],
       [2.92525000e-01, 8.07712896e-07, 5.91437652e-09],
       [2.92824000e-01, 8.06289610e-07, 5.92813027e-09],
       [2.93123000e-01, 8.04755362e-07, 5.94105354e-09],
       [2.93422000e-01, 8.03120053e-07, 5.95320944e-09],
       [2.93721000e-01, 8.01394986e-07, 5.96467265e-09],
       [2.94020000e-01, 7.99592626e-07, 5.97552783e-09],
       [2.94319000e-01, 7.97726322e-07, 5.98586777e-09],
       [2.94618000e-01, 7.95810252e-07, 5.99579309e-09],
       [2.94917000e-01, 7.93859076e-07, 6.00540974e-09],
       [2.95216000e-01, 7.91887714e-07, 6.01482742e-09],
       [2.95515000e-01, 7.89911139e-07, 6.02415806e-09],
       [2.95814000e-01, 7.87944211e-07, 6.03351456e-09],
       [2.96113000e-01, 7.86001287e-07, 6.04300779e-09],
       [2.96412000e-01, 7.84096232e-07, 6.05274662e-09],
       [2.96711000e-01, 7.82242019e-07, 6.06283473e-09],
       [2.97010000e-01, 7.80450682e-07, 6.07337016e-09],
       [2.97309000e-01, 7.78733089e-07, 6.08444337e-09],
       [2.97608000e-01, 7.77098824e-07, 6.09613614e-09],
       [2.97907000e-01, 7.75556068e-07, 6.10852045e-09],
       [2.98206000e-01, 7.74111456e-07, 6.12165717e-09],
       [2.98505000e-01, 7.72770095e-07, 6.13559589e-09],
       [2.98804000e-01, 7.71535439e-07, 6.15037374e-09],
       [2.99103000e-01, 7.70409305e-07, 6.16601527e-09],
       [2.99402000e-01, 7.69391843e-07, 6.18253190e-09],
       [2.99701000e-01, 7.68481665e-07, 6.19992275e-09],
       [3.00000000e-01, 7.67675773e-07, 6.21817376e-09]])

project='none'
patches=[1.0] 
resolution=[0.05] # dQ/Q=5%
background = [5e-7]
scale = [1.0]
qmax = [0.3]
global_param = []

system=[[
	[  2.07e-6, 0.0,  0, 0.0, 0.0, 'Silicon'],
	[  3.47e-6, 0.0, 30, 0.0, 0.0, 'Silica'],
	[  6.34e-6, 0.0,  0, 0.0, 1.0, 'D2O']
	]]

for i in range(10):
	system[0].insert(2+2*i,[5e-6, 0, 20, 0.0, 0.0, 'layer1'])
	system[0].insert(3+2*i,[1e-6, 0, 20, 0.0, 0.0, 'layer2'])

results = ref.calculate(project, resolution,
patches, system, global_param, background, scale, qmax, plot=False)

try:
  test1=np.testing.assert_allclose(results[("reflectivity")],curve, rtol=0.03)
except:
  print("ref.calculate function test not passed!")
  exit()


membrane_data=np.array([[8.770e-03, 1.013e+00, 2.163e-02, 8.857e-04],
       [9.870e-03, 1.034e+00, 2.244e-02, 9.953e-04],
       [1.097e-02, 9.943e-01, 2.125e-02, 1.100e-03],
       [1.206e-02, 1.029e+00, 2.232e-02, 1.210e-03],
       [1.316e-02, 9.970e-01, 2.132e-02, 1.320e-03],
       [1.426e-02, 7.720e-01, 1.687e-02, 1.430e-03],
       [1.535e-02, 3.234e-01, 7.320e-03, 1.540e-03],
       [1.645e-02, 1.415e-01, 3.480e-03, 1.650e-03],
       [1.755e-02, 7.864e-02, 2.080e-03, 1.760e-03],
       [1.865e-02, 4.872e-02, 1.430e-03, 1.870e-03],
       [1.974e-02, 3.721e-02, 1.190e-03, 1.980e-03],
       [2.083e-02, 2.626e-02, 9.347e-04, 2.090e-03],
       [2.193e-02, 2.158e-02, 8.379e-04, 2.200e-03],
       [2.303e-02, 1.699e-02, 7.077e-04, 2.310e-03],
       [2.413e-02, 1.213e-02, 5.840e-04, 2.420e-03],
       [2.522e-02, 1.130e-02, 5.607e-04, 2.520e-03],
       [2.632e-02, 8.340e-03, 4.687e-04, 2.640e-03],
       [2.631e-02, 8.970e-03, 7.671e-05, 2.680e-03],
       [2.851e-02, 6.150e-03, 5.697e-05, 2.900e-03],
       [3.070e-02, 4.500e-03, 4.503e-05, 3.110e-03],
       [3.289e-02, 3.480e-03, 3.783e-05, 3.330e-03],
       [3.508e-02, 2.740e-03, 3.217e-05, 3.540e-03],
       [3.728e-02, 2.210e-03, 2.789e-05, 3.760e-03],
       [3.948e-02, 1.910e-03, 2.551e-05, 3.980e-03],
       [4.167e-02, 1.650e-03, 2.326e-05, 4.200e-03],
       [4.387e-02, 1.480e-03, 2.186e-05, 4.410e-03],
       [4.606e-02, 1.310e-03, 2.032e-05, 4.630e-03],
       [4.825e-02, 1.190e-03, 1.915e-05, 4.850e-03],
       [5.044e-02, 1.070e-03, 1.794e-05, 5.070e-03],
       [5.263e-02, 1.010e-03, 1.735e-05, 5.290e-03],
       [5.482e-02, 9.525e-04, 1.686e-05, 5.500e-03],
       [5.702e-02, 8.627e-04, 1.604e-05, 5.720e-03],
       [5.921e-02, 7.974e-04, 1.520e-05, 5.940e-03],
       [6.140e-02, 7.652e-04, 1.492e-05, 6.160e-03],
       [6.360e-02, 7.130e-04, 1.444e-05, 6.380e-03],
       [6.578e-02, 6.572e-04, 1.379e-05, 6.600e-03],
       [6.798e-02, 6.386e-04, 1.369e-05, 6.820e-03],
       [7.017e-02, 5.924e-04, 1.303e-05, 7.040e-03],
       [7.237e-02, 5.483e-04, 1.263e-05, 7.250e-03],
       [7.456e-02, 4.846e-04, 1.182e-05, 7.470e-03],
       [7.675e-02, 5.165e-04, 1.208e-05, 7.690e-03],
       [7.895e-02, 4.334e-04, 1.116e-05, 7.910e-03],
       [8.114e-02, 4.199e-04, 1.100e-05, 8.130e-03],
       [8.333e-02, 3.900e-04, 1.067e-05, 8.350e-03],
       [8.553e-02, 3.573e-04, 1.022e-05, 8.570e-03],
       [8.770e-02, 3.236e-04, 9.594e-06, 8.780e-03],
       [8.990e-02, 3.154e-04, 9.537e-06, 9.000e-03],
       [9.210e-02, 2.809e-04, 9.025e-06, 9.220e-03],
       [9.429e-02, 2.616e-04, 8.728e-06, 9.440e-03],
       [9.647e-02, 2.466e-04, 8.461e-06, 9.660e-03],
       [9.867e-02, 2.189e-04, 8.001e-06, 9.880e-03],
       [9.867e-02, 2.181e-04, 2.349e-06, 9.950e-03],
       [1.030e-01, 1.831e-04, 2.133e-06, 1.038e-02],
       [1.074e-01, 1.447e-04, 1.908e-06, 1.082e-02],
       [1.118e-01, 1.146e-04, 1.700e-06, 1.125e-02],
       [1.162e-01, 9.006e-05, 1.534e-06, 1.169e-02],
       [1.206e-01, 7.205e-05, 1.381e-06, 1.212e-02],
       [1.250e-01, 5.397e-05, 1.238e-06, 1.256e-02],
       [1.293e-01, 4.079e-05, 1.115e-06, 1.300e-02],
       [1.337e-01, 2.949e-05, 1.002e-06, 1.343e-02],
       [1.381e-01, 2.345e-05, 9.285e-07, 1.387e-02],
       [1.315e-01, 3.714e-05, 6.403e-07, 1.329e-02],
       [1.359e-01, 2.473e-05, 5.642e-07, 1.372e-02],
       [1.403e-01, 1.758e-05, 5.171e-07, 1.416e-02],
       [1.447e-01, 1.237e-05, 4.730e-07, 1.459e-02],
       [1.491e-01, 8.356e-06, 4.426e-07, 1.502e-02],
       [1.534e-01, 4.807e-06, 4.186e-07, 1.546e-02],
       [1.578e-01, 3.104e-06, 3.999e-07, 1.589e-02],
       [1.622e-01, 2.876e-06, 3.959e-07, 1.633e-02],
       [1.666e-01, 1.635e-06, 3.832e-07, 1.676e-02],
       [1.710e-01, 1.761e-06, 3.788e-07, 1.720e-02],
       [1.753e-01, 9.550e-07, 3.715e-07, 1.763e-02],
       [1.753e-01, 8.281e-07, 2.338e-07, 1.771e-02],
       [1.797e-01, 1.030e-06, 2.328e-07, 1.814e-02],
       [1.841e-01, 2.228e-06, 2.371e-07, 1.858e-02],
       [1.884e-01, 2.235e-06, 2.363e-07, 1.901e-02],
       [1.928e-01, 2.294e-06, 2.346e-07, 1.944e-02],
       [1.972e-01, 2.539e-06, 2.336e-07, 1.988e-02]])


np.savetxt('test.out', membrane_data, delimiter=' ')   # X is an array

project='none'

input_file = 'test.out' # input curve
units = ['A'] # Q units in Angstrom

patches=[1.0] # single patch 100% covergae

# create system list with a signle model containing
# fronting/backing mediums and the
# 5 layers SiO2/water/heads/tails/heads
system = [[
	# Re_sld  Im_sld thk  rough  solv  description 
	[  2.07e-6, 0.0, 0,    1.09, 0.0,  'Si'],
	[  3.5e-6,  0.0, 12.0, 3.50, 0.0,  'SiO2'],
	[  6.15e-6, 0.0, 3.6,  'p0', 1.0,  'D2O'],
	[  1.7e-6,  0.0, 10.5, 'p0', 0.30, 'heads'],
	[ -0.4e-6,  0.0, 30.9, 'p0', 0.03, 'tails'],
	[  1.7e-6,  0.0, 6.3,  'p0', 0.20, 'heads'],
	[  6.15e-6, 0.0,  0,   0.0,  1.0,  'D2O'],
	]]

global_param = [
	['p0', 3.6, 'roughness'],
	]

resolution=[-1] # pointwise resolution
background = [5.3e-7] # instrumental background
scale = [1.05] # small scale correction
qmax = [0.25] 

results = ref.compare(project, input_file, units, resolution, 
	patches, system, global_param,background, scale, qmax, 
	experror=True, plot=True)

os.remove("test.out")

try:
  test2=np.testing.assert_almost_equal(results[("chi_square")],3.062012778345397, decimal=3)
except:
  print("ref.comparison function test not passed!")
  exit()


brush_data=np.array([[6.03800e-02, 4.88755e-05, 2.36710e-05],
       [5.78400e-02, 4.87175e-05, 1.97491e-05],
       [5.55200e-02, 3.71283e-05, 1.50372e-05],
       [5.33800e-02, 4.93030e-05, 1.43773e-05],
       [5.13800e-02, 7.72955e-05, 1.63383e-05],
       [4.95400e-02, 7.11059e-05, 1.44145e-05],
       [4.78200e-02, 7.74349e-05, 1.38662e-05],
       [4.62200e-02, 6.92658e-05, 1.23978e-05],
       [4.47200e-02, 8.82342e-05, 1.31784e-05],
       [4.33200e-02, 9.34944e-05, 1.28810e-05],
       [4.20200e-02, 9.10595e-05, 1.21004e-05],
       [4.07800e-02, 1.18401e-04, 1.34015e-05],
       [3.96000e-02, 1.03625e-04, 1.20353e-05],
       [3.85000e-02, 1.30204e-04, 1.29833e-05],
       [3.74600e-02, 1.44981e-04, 1.35130e-05],
       [3.64800e-02, 1.68123e-04, 1.45539e-05],
       [3.55400e-02, 1.91264e-04, 1.56227e-05],
       [3.46600e-02, 2.10223e-04, 1.61152e-05],
       [3.38000e-02, 2.27788e-04, 1.66357e-05],
       [3.30000e-02, 2.67844e-04, 1.80948e-05],
       [3.22400e-02, 2.90520e-04, 1.89405e-05],
       [3.15000e-02, 2.95818e-04, 1.87918e-05],
       [3.08000e-02, 3.06227e-04, 1.86617e-05],
       [3.01400e-02, 3.50558e-04, 2.00000e-05],
       [2.95000e-02, 3.78532e-04, 2.09851e-05],
       [2.88800e-02, 4.26487e-04, 2.25651e-05],
       [2.83000e-02, 4.07621e-04, 2.23885e-05],
       [2.77400e-02, 4.32807e-04, 2.34108e-05],
       [2.72000e-02, 4.96004e-04, 2.54647e-05],
       [2.66800e-02, 5.03717e-04, 2.61338e-05],
       [2.61600e-02, 5.50465e-04, 2.77695e-05],
       [2.56800e-02, 5.99814e-04, 2.94703e-05],
       [2.52200e-02, 6.15892e-04, 3.03810e-05],
       [2.47800e-02, 6.65520e-04, 3.21840e-05],
       [2.43400e-02, 7.07714e-04, 3.38383e-05],
       [2.39200e-02, 7.71933e-04, 3.60967e-05],
       [2.35200e-02, 7.92658e-04, 3.73141e-05],
       [2.31400e-02, 8.86524e-04, 4.03717e-05],
       [2.27600e-02, 9.46097e-04, 4.27602e-05],
       [2.24000e-02, 1.06000e-03, 4.65706e-05],
       [2.20400e-02, 1.03000e-03, 4.69424e-05],
       [2.17000e-02, 1.17000e-03, 5.10409e-05],
       [2.13600e-02, 1.28000e-03, 5.42193e-05],
       [2.10400e-02, 1.38000e-03, 5.75093e-05],
       [2.07400e-02, 1.26000e-03, 5.59758e-05],
       [2.04400e-02, 1.59000e-03, 6.45260e-05],
       [2.01400e-02, 1.79000e-03, 7.01394e-05],
       [1.98600e-02, 1.70000e-03, 6.97584e-05],
       [1.95800e-02, 1.96000e-03, 7.65335e-05],
       [1.93100e-02, 2.06000e-03, 8.03996e-05],
       [1.90500e-02, 2.25000e-03, 8.59944e-05],
       [1.88000e-02, 2.30000e-03, 8.88848e-05],
       [1.85500e-02, 2.50000e-03, 9.49814e-05],
       [1.83100e-02, 2.55000e-03, 9.81413e-05],
       [1.80700e-02, 2.70000e-03, 1.03253e-04],
       [1.78500e-02, 2.85000e-03, 1.08736e-04],
       [1.76200e-02, 3.01000e-03, 1.14126e-04],
       [1.74100e-02, 3.17000e-03, 1.19888e-04],
       [1.72000e-02, 3.26000e-03, 1.24814e-04],
       [1.69900e-02, 3.66000e-03, 1.35874e-04],
       [1.67900e-02, 3.82000e-03, 1.42007e-04],
       [1.65900e-02, 3.92000e-03, 1.47491e-04],
       [1.64000e-02, 3.95000e-03, 1.51580e-04],
       [1.62100e-02, 3.90000e-03, 1.54182e-04],
       [1.60300e-02, 4.37000e-03, 1.67565e-04],
       [1.58500e-02, 4.20000e-03, 1.68216e-04],
       [1.56800e-02, 4.54000e-03, 1.79554e-04],
       [1.55100e-02, 4.72000e-03, 1.88011e-04],
       [1.53400e-02, 5.00000e-03, 1.98420e-04],
       [1.51800e-02, 4.84000e-03, 1.99628e-04],
       [1.50200e-02, 5.07000e-03, 2.09851e-04],
       [1.48600e-02, 5.18000e-03, 2.17472e-04],
       [1.47100e-02, 5.21000e-03, 2.23699e-04],
       [1.45600e-02, 5.21000e-03, 2.27974e-04],
       [1.44100e-02, 5.05000e-03, 2.30297e-04],
       [1.42700e-02, 5.05000e-03, 2.35037e-04],
       [1.41300e-02, 5.57000e-03, 2.54833e-04],
       [1.39900e-02, 5.57000e-03, 2.60130e-04],
       [1.38600e-02, 5.16000e-03, 2.56691e-04],
       [1.37300e-02, 5.57000e-03, 2.73699e-04],
       [1.36000e-02, 5.41000e-03, 2.76487e-04],
       [1.34700e-02, 5.91000e-03, 2.97119e-04],
       [1.33500e-02, 5.72000e-03, 2.98420e-04],
       [1.32400e-02, 6.12000e-03, 3.16729e-04],
       [1.31200e-02, 6.81000e-03, 3.43494e-04],
       [1.30100e-02, 5.78000e-03, 3.22770e-04],
       [1.29000e-02, 6.12000e-03, 3.41450e-04],
       [1.27900e-02, 6.01000e-03, 3.47398e-04],
       [1.26800e-02, 6.09000e-03, 3.56691e-04],
       [1.25700e-02, 6.53000e-03, 3.80669e-04],
       [1.24600e-02, 6.52000e-03, 3.88104e-04],
       [1.23600e-02, 7.27000e-03, 4.22584e-04],
       [1.22500e-02, 6.84000e-03, 4.19796e-04],
       [1.21500e-02, 6.26000e-03, 4.08922e-04],
       [1.20500e-02, 6.83000e-03, 4.37825e-04],
       [1.19500e-02, 6.82000e-03, 4.49814e-04],
       [1.18600e-02, 7.30000e-03, 4.78532e-04],
       [1.17600e-02, 7.41000e-03, 4.96933e-04],
       [1.16700e-02, 7.84000e-03, 5.27416e-04],
       [1.15800e-02, 8.29000e-03, 5.55576e-04],
       [1.14900e-02, 8.45000e-03, 5.78903e-04],
       [1.14000e-02, 8.29000e-03, 5.88662e-04],
       [1.13100e-02, 8.81000e-03, 6.23606e-04],
       [1.12200e-02, 1.06600e-02, 7.13848e-04],
       [1.11400e-02, 1.10200e-02, 7.47491e-04],
       [1.10500e-02, 9.39000e-03, 7.03903e-04],
       [1.09700e-02, 1.26000e-02, 8.44238e-04],
       [1.08900e-02, 1.21900e-02, 8.57156e-04],
       [1.08100e-02, 1.37400e-02, 9.41450e-04],
       [1.07300e-02, 1.47500e-02, 1.01000e-03],
       [1.06600e-02, 1.59700e-02, 1.09000e-03],
       [1.05800e-02, 1.56100e-02, 1.11000e-03],
       [1.05100e-02, 1.99900e-02, 1.33000e-03],
       [1.04300e-02, 1.91800e-02, 1.33000e-03],
       [1.03600e-02, 2.33500e-02, 1.53000e-03],
       [1.02900e-02, 2.66700e-02, 1.72000e-03],
       [1.02200e-02, 3.32200e-02, 2.02000e-03],
       [1.01500e-02, 3.20100e-02, 2.03000e-03],
       [1.00800e-02, 3.42000e-02, 2.20000e-03],
       [1.00100e-02, 3.84900e-02, 2.42000e-03],
       [9.95000e-03, 5.11500e-02, 2.96000e-03],
       [9.88000e-03, 5.68200e-02, 3.27000e-03],
       [9.82000e-03, 6.23500e-02, 3.55000e-03],
       [9.76000e-03, 7.33300e-02, 4.05000e-03],
       [9.69000e-03, 8.62900e-02, 4.67000e-03],
       [9.63000e-03, 9.43300e-02, 5.16000e-03],
       [9.57000e-03, 1.14960e-01, 6.04000e-03],
       [9.51000e-03, 1.11430e-01, 6.15000e-03],
       [9.45000e-03, 1.36620e-01, 7.21000e-03],
       [9.39000e-03, 1.65330e-01, 8.53000e-03],
       [9.34000e-03, 1.79000e-01, 9.50000e-03],
       [9.28000e-03, 2.14220e-01, 1.09400e-02],
       [9.22000e-03, 2.28160e-01, 1.19800e-02],
       [9.17000e-03, 2.67570e-01, 1.39600e-02],
       [9.11000e-03, 3.15430e-01, 1.62800e-02],
       [9.06000e-03, 3.30760e-01, 1.72200e-02],
       [9.01000e-03, 4.05950e-01, 2.11400e-02],
       [8.95000e-03, 4.21380e-01, 2.28400e-02],
       [8.90000e-03, 4.68400e-01, 2.57200e-02],
       [8.85000e-03, 5.11710e-01, 2.84900e-02],
       [8.80000e-03, 6.04180e-01, 3.42300e-02],
       [8.75000e-03, 6.15520e-01, 3.61200e-02],
       [8.70000e-03, 6.70540e-01, 3.95100e-02],
       [8.65000e-03, 6.65520e-01, 4.08000e-02],
       [8.60000e-03, 7.88290e-01, 5.04600e-02],
       [8.56000e-03, 8.38200e-01, 5.37500e-02],
       [8.51000e-03, 8.22120e-01, 5.43300e-02],
       [8.46000e-03, 9.00930e-01, 6.29000e-02],
       [8.42000e-03, 9.48880e-01, 6.88800e-02],
       [8.37000e-03, 9.24070e-01, 6.81500e-02],
       [8.33000e-03, 9.38660e-01, 7.07600e-02],
       [8.29000e-03, 9.55390e-01, 7.57200e-02],
       [8.24000e-03, 1.04461e+00, 8.37800e-02],
       [8.20000e-03, 1.09665e+00, 9.16400e-02],
       [8.16000e-03, 9.32160e-01, 8.18900e-02],
       [8.11000e-03, 9.97210e-01, 8.98400e-02],
       [8.07000e-03, 9.67470e-01, 9.05100e-02],
       [8.03000e-03, 9.43310e-01, 8.98500e-02],
       [7.99000e-03, 9.54460e-01, 9.49800e-02],
       [7.95000e-03, 9.70260e-01, 9.67500e-02],
       [7.91000e-03, 9.93490e-01, 1.00650e-01],
       [7.87000e-03, 1.01487e+00, 1.07060e-01],
       [7.83000e-03, 1.02602e+00, 1.11900e-01],
       [7.80000e-03, 1.03903e+00, 1.18030e-01],
       [7.76000e-03, 9.77700e-01, 1.12640e-01],
       [7.72000e-03, 8.28350e-01, 9.88800e-02],
       [7.68000e-03, 9.62830e-01, 1.15800e-01],
       [7.65000e-03, 1.08550e+00, 1.34760e-01],
       [7.61000e-03, 8.80760e-01, 1.12360e-01],
       [7.58000e-03, 9.92570e-01, 1.28810e-01],
       [7.54000e-03, 1.00558e+00, 1.32810e-01],
       [7.51000e-03, 1.17937e+00, 1.68770e-01],
       [7.47000e-03, 1.08271e+00, 1.54650e-01],
       [7.44000e-03, 1.09758e+00, 1.63380e-01],
       [7.40000e-03, 1.02602e+00, 1.49720e-01],
       [7.37000e-03, 8.81510e-01, 1.33550e-01],
       [7.34000e-03, 9.22960e-01, 1.43770e-01],
       [7.30000e-03, 8.75560e-01, 1.55020e-01],
       [7.27000e-03, 1.11710e+00, 2.03160e-01],
       [7.24000e-03, 1.22212e+00, 2.23880e-01]])

np.savetxt('test.out', brush_data, delimiter=' ')   # X is an array


project='none'
in_file=['test.out']
units=['A'] # Angstrom units
fit_mode=0 # using FOM1
fit_weight=[1] 
method = 'mcmc' # Markov Chain Monte Carlo

patches=[1.0] # single uniform layer

#Brush layer solvent volume fraction expression
#(n-1.5) x slice thickness gives the midpoint
# of each slice. The first slice in layer 2
# since the water layer is in position 1.

expr='1-p0+(p0/(p1**p2))*((p1/10)*(n-1.5))**p2'

system=[[
	# Re_sld Im_sld thk rough solv description
	[  4.32e-6, 0.0, 0, 5, 0.0, 'Quartz'],
	[ -0.56e-6, 0.0, 'p3', 3, 0.0, 'water'],
	[  5.86e-6, 0.0,  0, 0, 1.0, 'd-toluene'],
	]]

# we use 10 slices for the brush layer with
# thickness brush_length/10 and roughness
# brush_length/20 to smooth the profile
for i in range(10): 
	system[0].insert(2,[ 1.41e-6, 0.0,
	 'p1/10', 'p1/20', expr, 'layer'])


global_param = [
    # param  min  max  description  type='uniform'
    # param  mean  sd  description  type='normal'
	['p0', 0.02, 0.20, 'phi0','uniform'],
	['p1', 100, 700, 'brush_length','uniform'],
	['p2', 1, 4, 'exponent','uniform'],
	['p3', 5, 2, 'water thickness','normal'],
	]

multi_param = [] # no multi-parameters
constraints = [] # no constraints
resolution=[0.07] # dQ/Q=6%
background = [[0.0,0.0,'uniform']] #background corrected data
scale = [[1.0,1.0,'uniform']] #data correctly scaled

results = ref.fit(project, in_file, units, fit_mode,
fit_weight,method,resolution,patches, system,
global_param,multi_param, constraints,
background,scale,experror=True, plot=True,fast=True)


os.remove("test.out")

tpass=0
if results[("global_parameters","p0")][0] > 1.01e-01 - 4*1.00e-03 and results[("global_parameters","p0")][0] < 1.01e-01 + 4*1.00e-03:
	tpass=tpass+1


if results[("global_parameters","p1")][0] > 4.81e+02 - 4*2.74e-00 and results[("global_parameters","p1")][0] < 4.81e+02 + 4*2.74e-00:
	tpass=tpass+1


if results[("global_parameters","p2")][0] > 1.84e+00 - 4*4.82e-02 and results[("global_parameters","p2")][0] < 1.84e+00 + 4*4.82e-02:
	tpass=tpass+1

if results[("global_parameters","p3")][0] > 3.96e+00 - 4*1.23e-01 and results[("global_parameters","p3")][0] < 3.96e+00 + 4*1.23e-01:
	tpass=tpass+1


if tpass != 4:
  print("ref.fit function test not passed!")
  exit()


# ORSO validation tests
print(' ')

# test0
data=np.loadtxt('ORSO_validation_test0.dat', usecols = (0,1),comments = "#")
layers=np.loadtxt('test0.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = np.zeros_like(Q)
tmp = ref.Reflectivity(Q, dq, system, 0, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=8e-5)
  print("ORSO validation test #0 passed!")
except:
  print("ORSO validation test #0 not passed!")
  exit()

# test1
data=np.loadtxt('ORSO_validation_test1.dat', usecols = (0,1),comments = "#")
layers=np.loadtxt('test1.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = np.zeros_like(Q)
tmp = ref.Reflectivity(Q, dq, system, 0, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=8e-5)
  print("ORSO validation test #1 passed!")
except:
  print("ORSO validation test #1 not passed!")
  exit()

# test2
data=np.loadtxt('ORSO_validation_test2.dat', usecols = (0,1),comments = "#")
layers=np.loadtxt('test2.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = np.zeros_like(Q)
tmp = ref.Reflectivity(Q, dq, system, 0, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=8e-5)
  print("ORSO validation test #2 passed!")
except:
  print("ORSO validation test #2 not passed!")
  exit()

# test3
data=np.loadtxt('ORSO_validation_test3.dat', usecols = (0,1),comments = "#")
layers=np.loadtxt('test3.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = np.zeros_like(Q)
tmp = ref.Reflectivity(Q, dq, system, 0, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=8e-5)
  print("ORSO validation test #3 passed!")
except:
  print("ORSO validation test #3 not passed!")
  exit()


# test4
data=np.loadtxt('ORSO_validation_test4.dat', usecols = (0,1,2,3),comments = "#")
layers=np.loadtxt('test0.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = data[:, 3] * 2 * np.sqrt(2 * np.log(2))
tmp = ref.Reflectivity(Q, dq, system, -1, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=0.03)
  print("ORSO validation test #4 passed!")
except:
  print("ORSO validation test #4 not passed!")
  exit()


# test5
data=np.loadtxt('ORSO_validation_test5.dat', usecols = (0,1,2,3),comments = "#")
layers=np.loadtxt('test1.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = data[:, 3] * 2 * np.sqrt(2 * np.log(2))
tmp = ref.Reflectivity(Q, dq, system, -1, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=0.03)
  print("ORSO validation test #5 passed!")
except:
  print("ORSO validation test #5 not passed!")
  exit()

# test6
data=np.loadtxt('ORSO_validation_test6.dat', usecols = (0,1),comments = "#")
layers=np.loadtxt('test6.layers', usecols = (0,1,2,3),comments = "#")
Q = data[:,0]
patches=[1.0]
model=[]
for i in range(layers.shape[0]-1):
       model.append([layers[i,1]*1e-6,layers[i,2]*1e-6,layers[i,0],layers[i+1,3],0,'layer'])
model.append([layers[layers.shape[0]-1,1]*1e-6,layers[layers.shape[0]-1,2]*1e-6,layers[layers.shape[0]-1,0],0,0,'layer'])

system=[model]
dq = np.zeros_like(Q)
tmp = ref.Reflectivity(Q, dq, system, 0, 0, 1, patches, 1) 
try:
  test=np.testing.assert_allclose(tmp[:, 1], data[:, 1], rtol=8e-5)
  print("ORSO validation test #6 passed!")
except:
  print("ORSO validation test #6 not passed!")
  exit()

print(' ')
print('More details on ORSO validation tests can be found here: https://github.com/reflectivity/analysis/tree/master/validation/test/unpolarised' )
print(' ')
print('All anaklasis tests passed!')
